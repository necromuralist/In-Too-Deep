<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Finding the autocorrect word closest to the original." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Autocorrect: Minimum Edit Distance | Neurotic Networking</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Neurotic-Networking/posts/nlp/autocorrect-minimum-edit-distance/" rel="canonical"><!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../autocorrect-system-combining-the-edits/" rel="prev" title="Autocorrect System: Combining the Edits" type="text/html">
<link href="../autocorrect-minimum-edit-distance-backtrace/" rel="next" title="Autocorrect: Minimum Edit Distance Backtrace" type="text/html">
<meta content="Neurotic Networking" property="og:site_name">
<meta content="Autocorrect: Minimum Edit Distance" property="og:title">
<meta content="https://necromuralist.github.io/Neurotic-Networking/posts/nlp/autocorrect-minimum-edit-distance/" property="og:url">
<meta content="Finding the autocorrect word closest to the original." property="og:description">
<meta content="article" property="og:type">
<meta content="2020-11-07T22:23:42-08:00" property="article:published_time">
<meta content="autocorrect" property="article:tag">
<meta content="edit distance" property="article:tag">
<meta content="nlp" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../../"><span id="blog-title">Neurotic Networking</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../rss.xml">RSS feed</a></li>
<li class="nav-item"><a class="nav-link" href="https://necromuralist.github.io/">Cloistered Monkey</a></li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/Neurotic-Networking/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Autocorrect: Minimum Edit Distance</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2020-11-07T22:23:42-08:00" itemprop="datePublished" title="2020-11-07 22:23">2020-11-07 22:23</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orga5ad404">Beginning</a>
<ul>
<li><a href="#org56a9228">Imports</a></li>
<li><a href="#org9e87cc5">Set Up</a></li>
</ul>
</li>
<li><a href="#orgf47de7a">Minimum Edit distance</a>
<ul>
<li>
<ul>
<li><a href="#orgfd2873f">Dynamic Programming</a></li>
</ul>
</li>
<li><a href="#org2eb4381">Testing the Function</a>
<ul>
<li><a href="#orgc0a31ca">play to stay</a></li>
<li><a href="#orgdff8576">eer to near</a></li>
<li><a href="#orgacbbf92">intention to execution</a></li>
</ul>
</li>
<li><a href="#orgaa1da2b">Finding the Closest of Multiple Strings</a>
<ul>
<li><a href="#orgf266375">One Letter Edits</a></li>
<li><a href="#orgf5246ce">Two Letter Edits</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org87f48d2">End</a>
<ul>
<li><a href="#org9087965">A Class-Based Minimum Edit Distance</a>
<ul>
<li><a href="#org20fcbe6">Imports</a></li>
<li><a href="#org26d4cbb">The Minimum Edit Distance</a></li>
<li><a href="#org53b9f87">Rows</a></li>
<li><a href="#orgf1c25a4">Columns</a></li>
<li><a href="#orge4a4fbc">The Table</a></li>
<li><a href="#org4874251">Distance Frame</a></li>
<li><a href="#org079ccda">Minimum Distance</a></li>
<li><a href="#orgbbcaff1">Distance String</a></li>
</ul>
</li>
<li><a href="#orge09b350">Test Out the Minimum Distance</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orga5ad404">
<h2 id="orga5ad404">Beginning</h2>
<div class="outline-text-2" id="text-orga5ad404">
<p>This is a post in the series of posts introduced <a href="../autocorrect-the-system/">here</a>. Now that we <a href="../autocorrect-system-combining-the-edits/">implemented auto-correct</a>, how do we evaluate the similarity between two strings (e.g. 'waht' and 'what')?</p>
<p>Also how do you efficiently find the shortest path to go from the word, 'waht' to the word 'what'?</p>
<p>We'll implement a dynamic programming system that will tell us the minimum number of edits required to convert a string into another string.</p>
</div>
<div class="outline-3" id="outline-container-org56a9228">
<h3 id="org56a9228">Imports</h3>
<div class="outline-text-3" id="text-org56a9228">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># from pypi</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># this repo</span>
<span class="kn">from</span> <span class="nn">neurotic.nlp.autocorrect.preprocessing</span> <span class="kn">import</span> <span class="n">CorpusBuilder</span>
<span class="kn">from</span> <span class="nn">neurotic.nlp.autocorrect.suggestor</span> <span class="kn">import</span> <span class="n">WordSuggestor</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org9e87cc5">
<h3 id="org9e87cc5">Set Up</h3>
<div class="outline-text-3" id="text-org9e87cc5">
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">"posts/nlp/.env"</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"SHAKESPEARE"</span><span class="p">])</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="n">CorpusBuilder</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">suggestor</span> <span class="o">=</span> <span class="n">WordSuggestor</span><span class="p">(</span><span class="n">corpus</span><span class="o">=</span><span class="n">corpus</span><span class="p">,</span> <span class="n">suggestions</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">want_switches</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf47de7a">
<h2 id="orgf47de7a">Minimum Edit distance</h2>
<div class="outline-text-2" id="text-orgf47de7a"></div>
<div class="outline-4" id="outline-container-orgfd2873f">
<h4 id="orgfd2873f">Dynamic Programming</h4>
<div class="outline-text-4" id="text-orgfd2873f">
<p>Dynamic Programming breaks a problem down into subproblems which can be combined to form the final solution. Here, given a string \(source_{[0 \ldots i]}\) and a string \(target_{[0 \ldots j]}\), we will compute all the combinations of \(substrings_{[i, j]}\) and calculate their edit distance. To do this efficiently, we will use a table to maintain the previously computed substrings and use those to calculate larger substrings.</p>
<p>We'll create a matrix and update each element in the matrix as follows:</p>
<p>\[ \text{Initialization} \]</p>
\begin{align} D[0,0] &amp;= 0 \\ D[i,0] &amp;= D[i-1,0] + del\_cost(source[i]) \tag{4}\\ D[0,j] &amp;= D[0,j-1] + ins\_cost(target[j]) \\ \end{align}
<p>\[ \text{Per Cell Operations} \]</p>
\begin{align} D[i,j] =min \begin{cases} D[i-1,j] + del\_cost\\ D[i,j-1] + ins\_cost\\ D[i-1,j-1] + \left\{\begin{matrix} rep\_cost; & \textit{if src}[i]\neq tar[j]\\ 0 ; & \textit{if src}[i]=tar[j] \end{matrix}\right. \end{cases} \tag{5} \end{align}
<p>So converting the source word <b>play</b> to the target word <b>stay</b>, using an insert cost of one, a delete cost of 1, and replace cost of 2 would give you the following table:</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<tbody>
<tr>
<td class="org-left">&nbsp;</td>
<td class="org-right">#</td>
<td class="org-right">s</td>
<td class="org-right">t</td>
<td class="org-right">a</td>
<td class="org-right">y</td>
</tr>
<tr>
<td class="org-left">#</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
</tr>
<tr>
<td class="org-left">p</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
</tr>
<tr>
<td class="org-left">l</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
</tr>
<tr>
<td class="org-left">a</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
</tr>
<tr>
<td class="org-left">y</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
<td class="org-right">5</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
<p>The operations used in this algorithm are 'insert', 'delete', and 'replace'. These correspond to the functions that you defined earlier: insert_letter(), delete_letter() and replace_letter(). switch_letter() is not used here.</p>
<p>The diagram below describes how to initialize the table. Each entry in D[i,j] represents the minimum cost of converting string source[0:i] to string target[0:j]. The first column is initialized to represent the cumulative cost of deleting the source characters to convert string "EER" to "". The first row is initialized to represent the cumulative cost of inserting the target characters to convert from "" to "NEAR".</p>
\begin{align} D[i,j] =min \begin{cases} D[i-1,j] + del\_cost\\ D[i,j-1] + ins\_cost\\ D[i-1,j-1] + \left\{\begin{matrix} rep\_cost; & if src[i]\neq tar[j]\\ 0 ; & if src[i]=tar[j] \end{matrix}\right. \end{cases} \tag{5} \end{align}
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">min_edit_distance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">ins_cost</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">del_cost</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rep_cost</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Input: </span>
<span class="sd">       source: a string corresponding to the string you are starting with</span>
<span class="sd">       target: a string corresponding to the string you want to end with</span>
<span class="sd">       ins_cost: an integer setting the insert cost</span>
<span class="sd">       del_cost: an integer setting the delete cost</span>
<span class="sd">       rep_cost: an integer setting the replace cost</span>
<span class="sd">    Output:</span>
<span class="sd">       D: a matrix of len(source)+1 by len(target)+1 containing minimum edit distances</span>
<span class="sd">       med: the minimum edit distance (med) required to convert the source string to the target</span>
<span class="sd">    '''</span>
    <span class="c1"># use deletion and insert cost as  1</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> 
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> 
    <span class="c1">#initialize cost matrix with zeros and dimensions (m+1,n+1) </span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> 


    <span class="c1"># Fill in column 0, from row 1 to row m, both inclusive</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> <span class="c1"># Replace None with the proper range</span>
        <span class="n">D</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">del_cost</span>

    <span class="c1"># Fill in row 0, for all columns from 1 to n, both inclusive</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> <span class="c1"># Replace None with the proper range</span>
        <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ins_cost</span>

    <span class="c1"># Loop through row 1 to row m, both inclusive</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> 

        <span class="c1"># Loop through column 1 to column n, both inclusive</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">r_cost</span> <span class="o">=</span> <span class="n">rep_cost</span>

            <span class="k">if</span> <span class="n">source</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">target</span><span class="p">[</span><span class="n">col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="n">r_cost</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">D</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">D</span><span class="p">[</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">+</span> <span class="n">del_cost</span><span class="p">),</span>
                             <span class="n">D</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ins_cost</span><span class="p">,</span>
                             <span class="n">D</span><span class="p">[</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r_cost</span><span class="p">)</span>

    <span class="c1"># Set the minimum edit distance with the cost found at row m, column n</span>
    <span class="n">med</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">D</span><span class="p">,</span> <span class="n">med</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org2eb4381">
<h3 id="org2eb4381">Testing the Function</h3>
<div class="outline-text-3" id="text-org2eb4381"></div>
<div class="outline-4" id="outline-container-orgc0a31ca">
<h4 id="orgc0a31ca">play to stay</h4>
<div class="outline-text-4" id="text-orgc0a31ca">
<div class="highlight">
<pre><span></span><span class="n">source</span> <span class="o">=</span>  <span class="s1">'play'</span>
<span class="n">target</span> <span class="o">=</span> <span class="s1">'stay'</span>
<span class="n">matrix</span><span class="p">,</span> <span class="n">min_edits</span> <span class="o">=</span> <span class="n">min_edit_distance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"minimum edits: "</span><span class="p">,</span><span class="n">min_edits</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s1">'#'</span> <span class="o">+</span> <span class="n">source</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s1">'#'</span> <span class="o">+</span> <span class="n">target</span><span class="p">)</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
<span class="p">]),</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="n">cols</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">min_edits</span><span class="o">==</span><span class="mi">4</span>

<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">expected</span> <span class="o">==</span> <span class="n">actual</span><span class="p">)</span>
</pre></div>
<pre class="example">
minimum edits:  4 

   #  s  t  a  y
#  0  1  2  3  4
p  1  2  3  4  5
l  2  3  4  5  6
a  3  4  5  4  5
y  4  5  6  5  4
</pre></div>
</div>
<div class="outline-4" id="outline-container-orgdff8576">
<h4 id="orgdff8576">eer to near</h4>
<div class="outline-text-4" id="text-orgdff8576">
<div class="highlight">
<pre><span></span><span class="n">source</span> <span class="o">=</span>  <span class="s1">'eer'</span>
<span class="n">target</span> <span class="o">=</span> <span class="s1">'near'</span>
<span class="n">matrix</span><span class="p">,</span> <span class="n">min_edits</span> <span class="o">=</span> <span class="n">min_edit_distance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"minimum edits: "</span><span class="p">,</span><span class="n">min_edits</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="n">idx</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'#'</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<span class="n">cols</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'#'</span><span class="p">)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="n">cols</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
    <span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">expected</span> <span class="o">==</span> <span class="n">actual</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">min_edits</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
<pre class="example">
minimum edits:  3 

   #  n  e  a  r
#  0  1  2  3  4
e  1  2  1  2  3
e  2  3  2  3  4
r  3  4  3  4  3
</pre></div>
</div>
<div class="outline-4" id="outline-container-orgacbbf92">
<h4 id="orgacbbf92">intention to execution</h4>
<div class="outline-text-4" id="text-orgacbbf92">
<div class="highlight">
<pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="s2">"intention"</span>
<span class="n">target</span> <span class="o">=</span> <span class="s2">"execution"</span>
<span class="n">matrix</span><span class="p">,</span> <span class="n">min_edits</span> <span class="o">=</span> <span class="n">min_edit_distance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"minimum edits: "</span><span class="p">,</span><span class="n">min_edits</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">"#"</span> <span class="o">+</span> <span class="n">source</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">"#"</span> <span class="o">+</span> <span class="n">target</span><span class="p">)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
<span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">expected</span> <span class="o">==</span> <span class="n">actual</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">min_edits</span> <span class="o">==</span> <span class="mi">8</span>
</pre></div>
<pre class="example" id="org2991401">
minimum edits:  8 

   #  e  x   e   c   u   t   i   o   n
#  0  1  2   3   4   5   6   7   8   9
i  1  2  3   4   5   6   7   6   7   8
n  2  3  4   5   6   7   8   7   8   7
t  3  4  5   6   7   8   7   8   9   8
e  4  3  4   5   6   7   8   9  10   9
n  5  4  5   6   7   8   9  10  11  10
t  6  5  6   7   8   9   8   9  10  11
i  7  6  7   8   9  10   9   8   9  10
o  8  7  8   9  10  11  10   9   8   9
n  9  8  9  10  11  12  11  10   9   8
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgaa1da2b">
<h3 id="orgaa1da2b">Finding the Closest of Multiple Strings</h3>
<div class="outline-text-3" id="text-orgaa1da2b"></div>
<div class="outline-4" id="outline-container-orgf266375">
<h4 id="orgf266375">One Letter Edits</h4>
<div class="outline-text-4" id="text-orgf266375">
<div class="highlight">
<pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="s2">"eer"</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">suggestor</span><span class="o">.</span><span class="n">one_letter_edits</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="n">rep_cost</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">min_edits</span> <span class="o">=</span> <span class="n">min_edit_distance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">rep_cost</span><span class="o">=</span><span class="n">rep_cost</span><span class="p">)</span>  <span class="c1"># set ins, del, sub costs all to one</span>
    <span class="k">if</span> <span class="n">min_edits</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">min_edits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgf5246ce">
<h4 id="orgf5246ce">Two Letter Edits</h4>
<div class="outline-text-4" id="text-orgf5246ce">
<p>The 'replace()' routine utilizes all letters a-z one of which returns the original word.</p>
<div class="highlight">
<pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="s2">"eer"</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">suggestor</span><span class="o">.</span><span class="n">two_letter_edits</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">min_edits</span> <span class="o">=</span> <span class="n">min_edit_distance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span><span class="n">rep_cost</span><span class="o">=</span><span class="n">rep_cost</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_edits</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">min_edits</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">min_edits</span><span class="p">)</span>
</pre></div>
<pre class="example">
eer eer 0
</pre>
<p>We have to allow single edits here because some two_edits will restore a single edit.</p>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org87f48d2">
<h2 id="org87f48d2">End</h2>
<div class="outline-text-2" id="text-org87f48d2">
<p>The next post will be about <a href="../autocorrect-minimum-edit-distance-backtrace/">implementing backtrace</a> to find the shortest path to the minimum edit distance.</p>
</div>
<div class="outline-3" id="outline-container-org9087965">
<h3 id="org9087965">A Class-Based Minimum Edit Distance</h3>
<div class="outline-text-3" id="text-org9087965"></div>
<div class="outline-4" id="outline-container-org20fcbe6">
<h4 id="org20fcbe6">Imports</h4>
<div class="outline-text-4" id="text-org20fcbe6">
<div class="highlight">
<pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">import</span> <span class="nn">attr</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org26d4cbb">
<h4 id="org26d4cbb">The Minimum Edit Distance</h4>
<div class="outline-text-4" id="text-org26d4cbb">
<div class="highlight">
<pre><span></span><span class="nd">@attr</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">auto_attribs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">MinimumEdits</span><span class="p">:</span>
    <span class="sd">"""Calculates the minimum edit distance between two strings</span>

<span class="sd">    Uses the Levenshtein distance</span>

<span class="sd">    Args:</span>
<span class="sd">     source: the starting string</span>
<span class="sd">     target: what to transform the source to</span>
<span class="sd">     insertion_cost: how much inserting a character costs</span>
<span class="sd">     deletion_cost: how much deleting a character costs</span>
<span class="sd">     replacement_cost: how much swapping out a character costs</span>
<span class="sd">     table_format: tabluate table format for printing table</span>
<span class="sd">    """</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">insertion_cost</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">deletion_cost</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">replacement_cost</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">table_format</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">"orgtbl"</span>
    <span class="n">_rows</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_columns</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_distance_table</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_distance_frame</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_minimum_distance</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_backtrace</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org53b9f87">
<h4 id="org53b9f87">Rows</h4>
<div class="outline-text-4" id="text-org53b9f87">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""Rows in the table"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgf1c25a4">
<h4 id="orgf1c25a4">Columns</h4>
<div class="outline-text-4" id="text-orgf1c25a4">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""Number of columns for the table"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orge4a4fbc">
<h4 id="orge4a4fbc">The Table</h4>
<div class="outline-text-4" id="text-orge4a4fbc">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">distance_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">"""Table of edit distances"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                                           <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="c1"># initialize the first row</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deletion_cost</span><span class="p">)</span>
        <span class="c1"># initialize the first column</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                               <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">insertion_cost</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">one_row_back</span> <span class="o">=</span> <span class="n">row</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">one_column_back</span> <span class="o">=</span> <span class="n">column</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">replacement_cost</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="n">one_row_back</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">[</span><span class="n">one_column_back</span><span class="p">]</span>
                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">replacement_cost</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span><span class="p">[</span><span class="n">one_row_back</span><span class="p">,</span> <span class="n">column</span><span class="p">]</span>
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deletion_cost</span><span class="p">),</span>
                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">one_column_back</span><span class="p">]</span>
                      <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">insertion_cost</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span><span class="p">[</span><span class="n">one_row_back</span><span class="p">,</span> <span class="n">one_column_back</span><span class="p">]</span>
                     <span class="o">+</span> <span class="n">replacement_cost</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_distance_table</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org4874251">
<h4 id="org4874251">Distance Frame</h4>
<div class="outline-text-4" id="text-org4874251">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">distance_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">"""pandas dataframe of the distance table"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_distance_frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_distance_frame</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distance_table</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">"#"</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">),</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">"#"</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_distance_frame</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org079ccda">
<h4 id="org079ccda">Minimum Distance</h4>
<div class="outline-text-4" id="text-org079ccda">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">minimum_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""The minimum edit distance from source to target"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minimum_distance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_minimum_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_table</span><span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minimum_distance</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgbbcaff1">
<h4 id="orgbbcaff1">Distance String</h4>
<div class="outline-text-4" id="text-orgbbcaff1">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""tabluate version of distance frame</span>

<span class="sd">    Returns:</span>
<span class="sd">     table formatted string of distance table</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">tabulate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_frame</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table_format</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orge09b350">
<h3 id="orge09b350">Test Out the Minimum Distance</h3>
<div class="outline-text-3" id="text-orge09b350">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">neurotic.nlp.autocorrect.distance</span> <span class="kn">import</span> <span class="n">MinimumEdits</span>

<span class="n">SOURCE</span><span class="p">,</span> <span class="n">TARGET</span> <span class="o">=</span> <span class="s2">"cow"</span><span class="p">,</span> <span class="s2">"dog"</span>
<span class="n">editor</span> <span class="o">=</span> <span class="n">MinimumEdits</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">SOURCE</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">TARGET</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">editor</span><span class="o">.</span><span class="n">rows</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">SOURCE</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">editor</span><span class="o">.</span><span class="n">columns</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">TARGET</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">editor</span><span class="o">.</span><span class="n">distance_table</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SOURCE</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">TARGET</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">editor</span><span class="o">.</span><span class="n">distance_table</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">editor</span><span class="o">.</span><span class="n">rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">editor</span><span class="o">.</span><span class="n">distance_table</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">editor</span><span class="o">.</span><span class="n">columns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">editor</span><span class="o">.</span><span class="n">distance_table</span> <span class="o">==</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">editor</span><span class="o">.</span><span class="n">minimum_distance</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">editor</span> <span class="o">=</span> <span class="n">MinimumEdits</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"play"</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">"stay"</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">editor</span><span class="o">.</span><span class="n">minimum_distance</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">editor</span> <span class="o">=</span> <span class="n">MinimumEdits</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"eer"</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">"near"</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">editor</span><span class="o">.</span><span class="n">minimum_distance</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">editor</span> <span class="o">=</span> <span class="n">MinimumEdits</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"intention"</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">"execution"</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">editor</span><span class="o">.</span><span class="n">minimum_distance</span> <span class="o">==</span> <span class="mi">8</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">editor</span><span class="o">.</span><span class="n">distance_frame</span><span class="p">)</span>
</pre></div>
<pre class="example">
   #  d  o  g
#  0  1  2  3
c  1  2  3  4
o  2  3  2  3
w  3  4  3  4
</pre>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">editor</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">&nbsp;</th>
<th class="org-right" scope="col">#</th>
<th class="org-right" scope="col">d</th>
<th class="org-right" scope="col">o</th>
<th class="org-right" scope="col">g</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">#</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">c</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
</tr>
<tr>
<td class="org-left">o</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">w</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../categories/autocorrect/" rel="tag">autocorrect</a></li>
<li><a class="tag p-category" href="../../../categories/edit-distance/" rel="tag">edit distance</a></li>
<li><a class="tag p-category" href="../../../categories/nlp/" rel="tag">nlp</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../autocorrect-system-combining-the-edits/" rel="prev" title="Autocorrect System: Combining the Edits">Previous post</a></li>
<li class="next"><a href="../autocorrect-minimum-edit-distance-backtrace/" rel="next" title="Autocorrect: Minimum Edit Distance Backtrace">Next post</a></li>
</ul>
</nav>
</aside>
<script async id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
<script type="text/x-mathjax-config">

        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']],},

        });
</script>
<link href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script>
<script>

    MathJax = {
        tex: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [['$$','$$'], ['\\[','\\]']],
            processEscapes: true,
            processEnvironments: true,
        }
    }
</script>
<link href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script></article>
<!--End of body content-->
<footer id="footer"><a href="https://creativecommons.org/licenses/by/4.0/" rel="license"><img alt="Creative Commons License" id="license-image" src="https://licensebuttons.net/l/by/4.0/80x15.png" style="border-width:0"></a>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0 International License</a>. <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
