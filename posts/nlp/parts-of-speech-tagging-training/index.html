<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Training the POS model." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Parts-of-Speech Tagging: Training | Neurotic Networking</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Neurotic-Networking/posts/nlp/parts-of-speech-tagging-training/" rel="canonical"><!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../parts-of-speech-tagging-the-data/" rel="prev" title="Parts-of-Speech Tagging: The Data" type="text/html">
<link href="../parts-of-speech-tagging-most-frequent-class-baseline/" rel="next" title="Parts-of-Speech Tagging: Most Frequent Class Baseline" type="text/html">
<meta content="Neurotic Networking" property="og:site_name">
<meta content="Parts-of-Speech Tagging: Training" property="og:title">
<meta content="https://necromuralist.github.io/Neurotic-Networking/posts/nlp/parts-of-speech-tagging-training/" property="og:url">
<meta content="Training the POS model." property="og:description">
<meta content="article" property="og:type">
<meta content="2020-11-16T21:23:21-08:00" property="article:published_time">
<meta content="nlp" property="article:tag">
<meta content="pos tagging" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../../"><span id="blog-title">Neurotic Networking</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../rss.xml">RSS feed</a></li>
<li class="nav-item"><a class="nav-link" href="https://necromuralist.github.io/">Cloistered Monkey</a></li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/Neurotic-Networking/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Parts-of-Speech Tagging: Training</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2020-11-16T21:23:21-08:00" itemprop="datePublished" title="2020-11-16 21:23">2020-11-16 21:23</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3e27396">Beginning</a>
<ul>
<li><a href="#org6b927e2">Imports</a></li>
<li><a href="#orgd7ba36c">Set Up</a>
<ul>
<li><a href="#org13bcad2">The Environment</a></li>
<li><a href="#org5a4c581">The Data</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org847fdb1">Training</a>
<ul>
<li><a href="#org1276243">Preprocessing</a></li>
<li><a href="#orga92d2e8">Transition counts</a></li>
<li><a href="#org830c91e">Emission counts</a></li>
<li><a href="#org204c0b3">Tag counts</a></li>
</ul>
</li>
<li><a href="#org13046f8">Bundle It Up</a>
<ul>
<li><a href="#org13bd408">Imports</a></li>
<li><a href="#org6c069ab">The Trainer</a>
<ul>
<li><a href="#org753a3f7">Transition Counts</a></li>
<li><a href="#org0921a16">Emission Counts</a></li>
<li><a href="#orgfcc442f">Tag Counts</a></li>
</ul>
</li>
<li><a href="#orgdc4f89a">Test It Out</a>
<ul>
<li><a href="#orge324530">Tag Counts</a></li>
<li><a href="#org2b9f049">Transition Counts</a></li>
<li><a href="#org37a7d7b">Emission Counts</a></li>
<li><a href="#org3d3a190">Ambiuguous Word Emission Counts</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org3e27396">
<h2 id="org3e27396">Beginning</h2>
<div class="outline-text-2" id="text-org3e27396"></div>
<div class="outline-3" id="outline-container-org6b927e2">
<h3 id="org6b927e2">Imports</h3>
<div class="outline-text-3" id="text-org6b927e2">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>

<span class="c1"># this repository</span>
<span class="kn">from</span> <span class="nn">neurotic.nlp.parts_of_speech.preprocessing</span> <span class="kn">import</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">DataLoader</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgd7ba36c">
<h3 id="orgd7ba36c">Set Up</h3>
<div class="outline-text-3" id="text-orgd7ba36c"></div>
<div class="outline-4" id="outline-container-org13bcad2">
<h4 id="org13bcad2">The Environment</h4>
<div class="outline-text-4" id="text-org13bcad2">
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">"posts/nlp/.env"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org5a4c581">
<h4 id="org5a4c581">The Data</h4>
<div class="outline-text-4" id="text-org5a4c581">
<div class="highlight">
<pre><span></span><span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org847fdb1">
<h2 id="org847fdb1">Training</h2>
<div class="outline-text-2" id="text-org847fdb1">
<p>In this section, you will find the words that are not ambiguous.</p>
<ul class="org-ul">
<li>For example, the word <code>is</code> is a verb and it is not ambiguous.</li>
<li>In the <code>WSJ</code> corpus, <i>86%</i> of the tokens are unambiguous (meaning they have only one tag)</li>
<li>About <i>14%</i> <i>are</i> ambiguous (meaning that they have more than one tag)</li>
</ul>
<p>Before you start predicting the tags of each word, you will need to compute a few dictionaries that will help you to generate the tables.</p>
</div>
<div class="outline-3" id="outline-container-org1276243">
<h3 id="org1276243">Preprocessing</h3>
<div class="outline-text-3" id="text-org1276243">
<div class="highlight">
<pre><span></span><span class="c1"># replace the next three code blocks once the assignment is done</span>
<span class="kn">import</span> <span class="nn">string</span>

<span class="n">punct</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">)</span>
<span class="n">noun_suffix</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"action"</span><span class="p">,</span> <span class="s2">"age"</span><span class="p">,</span> <span class="s2">"ance"</span><span class="p">,</span> <span class="s2">"cy"</span><span class="p">,</span> <span class="s2">"dom"</span><span class="p">,</span> <span class="s2">"ee"</span><span class="p">,</span> <span class="s2">"ence"</span><span class="p">,</span> <span class="s2">"er"</span><span class="p">,</span> <span class="s2">"hood"</span><span class="p">,</span> <span class="s2">"ion"</span><span class="p">,</span> <span class="s2">"ism"</span><span class="p">,</span> <span class="s2">"ist"</span><span class="p">,</span> <span class="s2">"ity"</span><span class="p">,</span> <span class="s2">"ling"</span><span class="p">,</span> <span class="s2">"ment"</span><span class="p">,</span> <span class="s2">"ness"</span><span class="p">,</span> <span class="s2">"or"</span><span class="p">,</span> <span class="s2">"ry"</span><span class="p">,</span> <span class="s2">"scape"</span><span class="p">,</span> <span class="s2">"ship"</span><span class="p">,</span> <span class="s2">"ty"</span><span class="p">]</span>
<span class="n">verb_suffix</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"ate"</span><span class="p">,</span> <span class="s2">"ify"</span><span class="p">,</span> <span class="s2">"ise"</span><span class="p">,</span> <span class="s2">"ize"</span><span class="p">]</span>
<span class="n">adj_suffix</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"able"</span><span class="p">,</span> <span class="s2">"ese"</span><span class="p">,</span> <span class="s2">"ful"</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">,</span> <span class="s2">"ian"</span><span class="p">,</span> <span class="s2">"ible"</span><span class="p">,</span> <span class="s2">"ic"</span><span class="p">,</span> <span class="s2">"ish"</span><span class="p">,</span> <span class="s2">"ive"</span><span class="p">,</span> <span class="s2">"less"</span><span class="p">,</span> <span class="s2">"ly"</span><span class="p">,</span> <span class="s2">"ous"</span><span class="p">]</span>
<span class="n">adv_suffix</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"ward"</span><span class="p">,</span> <span class="s2">"wards"</span><span class="p">,</span> <span class="s2">"wise"</span><span class="p">]</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">get_word_tag</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">vocab</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="sd">"""splits line and handles unknowns and empty lines</span>


<span class="sd">    Args:</span>
<span class="sd">     line: whitespace separated string with word and tag</span>
<span class="sd">     vocab: hashable that holds the known words</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
        <span class="n">word</span> <span class="o">=</span> <span class="s2">"--n--"</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="s2">"--s--"</span>
        <span class="k">return</span> <span class="n">word</span><span class="p">,</span> <span class="n">tag</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">word</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vocab</span><span class="p">:</span> 
            <span class="c1"># Handle unknown words</span>
            <span class="n">word</span> <span class="o">=</span> <span class="n">assign_unk</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">word</span><span class="p">,</span> <span class="n">tag</span>
    <span class="k">return</span> <span class="kc">None</span> 
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">assign_unk</span><span class="p">(</span><span class="n">tok</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Assign unknown word tokens</span>
<span class="sd">    """</span>
    <span class="c1"># Digits</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">char</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">tok</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">"--unk_digit--"</span>

    <span class="c1"># Punctuation</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">char</span> <span class="ow">in</span> <span class="n">punct</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">tok</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">"--unk_punct--"</span>

    <span class="c1"># Upper-case</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">char</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">tok</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">"--unk_upper--"</span>

    <span class="c1"># Nouns</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="n">noun_suffix</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">"--unk_noun--"</span>

    <span class="c1"># Verbs</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="n">verb_suffix</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">"--unk_verb--"</span>

    <span class="c1"># Adjectives</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="n">adj_suffix</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">"--unk_adj--"</span>

    <span class="c1"># Adverbs</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="n">adv_suffix</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">"--unk_adv--"</span>

    <span class="k">return</span> <span class="s2">"--unk--"</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orga92d2e8">
<h3 id="orga92d2e8">Transition counts</h3>
<div class="outline-text-3" id="text-orga92d2e8">
<ul class="org-ul">
<li>The first dictionary is the <code>transition_counts</code> dictionary which computes the number of times each tag happened next to another tag.</li>
</ul>
<p>This dictionary will be used to compute: \[ P(t_i |t_{i-1}) \]</p>
<p>This is the probability of a tag at position <i>i</i> given the tag at position <i>i-1</i>.</p>
<p>In order for you to compute equation 1, you will create a <code>transition_counts</code> dictionary where</p>
<ul class="org-ul">
<li>The keys are <code>(prev_tag, tag)</code></li>
<li>The values are the number of times those two tags appeared in that order.</li>
</ul>
</div>
</div>
<div class="outline-3" id="outline-container-org830c91e">
<h3 id="org830c91e">Emission counts</h3>
<div class="outline-text-3" id="text-org830c91e">
<p>The second dictionary you will compute is the <code>emission_counts</code> dictionary. This dictionary will be used to compute:</p>
<p>\[ P(w_i|t_i) \]</p>
<p>In other words, you will use it to compute the probability of a word given its tag.</p>
<p>In order for you to compute equation 2, you will create an <code>emission_counts</code> dictionary where</p>
<ul class="org-ul">
<li>The keys are <code>(tag, word)</code></li>
<li>The values are the number of times that pair showed up in your training set.</li>
</ul>
</div>
</div>
<div class="outline-3" id="outline-container-org204c0b3">
<h3 id="org204c0b3">Tag counts</h3>
<div class="outline-text-3" id="text-org204c0b3">
<p>The last dictionary you will compute is the <code>tag_counts</code> dictionary.</p>
<ul class="org-ul">
<li>The key is the tag</li>
<li>The value is the number of times each tag appeared.</li>
</ul>
<div class="highlight">
<pre><span></span> <span class="k">def</span> <span class="nf">create_dictionaries</span><span class="p">(</span><span class="n">training_corpus</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">vocab</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
     <span class="sd">"""Creat the three training dictionaries</span>

<span class="sd">     Args: </span>
<span class="sd">        ``training_corpus``: a corpus where each line has a word followed by its tag.</span>
<span class="sd">        ``vocab``: a dictionary where keys are words in vocabulary and value is an index</span>
<span class="sd">     Returns: </span>
<span class="sd">        ``emission_counts``: a dictionary where the keys are (tag, word) and the values are the counts</span>
<span class="sd">        ``transition_counts``: a dictionary where the keys are (prev_tag, tag) and the values are the counts</span>
<span class="sd">        ``tag_counts``: a dictionary where the keys are the tags and the values are the counts</span>
<span class="sd">     """</span>

     <span class="c1"># initialize the dictionaries using defaultdict</span>
     <span class="n">emission_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
     <span class="n">transition_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
     <span class="n">tag_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

     <span class="c1"># Initialize "prev_tag" (previous tag) with the start state, denoted by '--s--'</span>
     <span class="n">prev_tag</span> <span class="o">=</span> <span class="s1">'--s--'</span> 

     <span class="c1"># use 'i' to track the line number in the corpus</span>
     <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> 

     <span class="c1"># Each item in the training corpus contains a word and its POS tag</span>
     <span class="c1"># Go through each word and its tag in the training corpus</span>
     <span class="k">for</span> <span class="n">word_tag</span> <span class="ow">in</span> <span class="n">training_corpus</span><span class="p">:</span>

         <span class="c1"># Increment the word_tag count</span>
         <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

         <span class="c1"># Every 50,000 words, print the word count</span>
         <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">50000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"word count = </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

         <span class="c1">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
         <span class="c1"># get the word and tag using the get_word_tag helper function (imported from utils_pos.py)</span>
         <span class="n">word</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">get_word_tag</span><span class="p">(</span><span class="n">word_tag</span><span class="p">,</span> <span class="n">vocab</span><span class="p">)</span>

         <span class="c1"># Increment the transition count for the previous word and tag</span>
         <span class="n">transition_counts</span><span class="p">[(</span><span class="n">prev_tag</span><span class="p">,</span> <span class="n">tag</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>

         <span class="c1"># Increment the emission count for the tag and word</span>
         <span class="n">emission_counts</span><span class="p">[(</span><span class="n">tag</span><span class="p">,</span> <span class="n">word</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>

         <span class="c1"># Increment the tag count</span>
         <span class="n">tag_counts</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

         <span class="c1"># Set the previous tag to this tag (for the next iteration of the loop)</span>
         <span class="n">prev_tag</span> <span class="o">=</span> <span class="n">tag</span>

         <span class="c1">### END CODE HERE ###</span>

     <span class="k">return</span> <span class="n">emission_counts</span><span class="p">,</span> <span class="n">transition_counts</span><span class="p">,</span> <span class="n">tag_counts</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">emission_counts</span><span class="p">,</span> <span class="n">transition_counts</span><span class="p">,</span> <span class="n">tag_counts</span> <span class="o">=</span> <span class="n">create_dictionaries</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">training_corpus</span><span class="p">,</span> <span class="n">loader</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">)</span>
</pre></div>
<p>Get all the POS states.</p>
<div class="highlight">
<pre><span></span><span class="n">states</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tag_counts</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of POS tags (number of 'states'): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"View these POS tags (states)"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>

<span class="n">expected_states</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'#'</span><span class="p">,</span> <span class="s1">'$'</span><span class="p">,</span> <span class="s2">"''"</span><span class="p">,</span> <span class="s1">'('</span><span class="p">,</span> <span class="s1">')'</span><span class="p">,</span> <span class="s1">','</span><span class="p">,</span> <span class="s1">'--s--'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">,</span> <span class="s1">':'</span><span class="p">,</span> <span class="s1">'CC'</span><span class="p">,</span> <span class="s1">'CD'</span><span class="p">,</span> <span class="s1">'DT'</span><span class="p">,</span> <span class="s1">'EX'</span><span class="p">,</span> <span class="s1">'FW'</span><span class="p">,</span> <span class="s1">'IN'</span><span class="p">,</span> <span class="s1">'JJ'</span><span class="p">,</span> <span class="s1">'JJR'</span><span class="p">,</span> <span class="s1">'JJS'</span><span class="p">,</span> <span class="s1">'LS'</span><span class="p">,</span> <span class="s1">'MD'</span><span class="p">,</span> <span class="s1">'NN'</span><span class="p">,</span> <span class="s1">'NNP'</span><span class="p">,</span> <span class="s1">'NNPS'</span><span class="p">,</span> <span class="s1">'NNS'</span><span class="p">,</span> <span class="s1">'PDT'</span><span class="p">,</span> <span class="s1">'POS'</span><span class="p">,</span> <span class="s1">'PRP'</span><span class="p">,</span> <span class="s1">'PRP$'</span><span class="p">,</span> <span class="s1">'RB'</span><span class="p">,</span> <span class="s1">'RBR'</span><span class="p">,</span> <span class="s1">'RBS'</span><span class="p">,</span> <span class="s1">'RP'</span><span class="p">,</span> <span class="s1">'SYM'</span><span class="p">,</span> <span class="s1">'TO'</span><span class="p">,</span> <span class="s1">'UH'</span><span class="p">,</span> <span class="s1">'VB'</span><span class="p">,</span> <span class="s1">'VBD'</span><span class="p">,</span> <span class="s1">'VBG'</span><span class="p">,</span> <span class="s1">'VBN'</span><span class="p">,</span> <span class="s1">'VBP'</span><span class="p">,</span> <span class="s1">'VBZ'</span><span class="p">,</span> <span class="s1">'WDT'</span><span class="p">,</span> <span class="s1">'WP'</span><span class="p">,</span> <span class="s1">'WP$'</span><span class="p">,</span> <span class="s1">'WRB'</span><span class="p">,</span> <span class="s1">'``'</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">expected_states</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">states</span><span class="p">))</span>
<span class="k">for</span> <span class="n">expected</span><span class="p">,</span> <span class="n">actual</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">expected_states</span><span class="p">,</span> <span class="n">states</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">expected</span> <span class="o">==</span> <span class="n">actual</span><span class="p">,</span> <span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)</span> <span class="o">==</span> <span class="mi">46</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>    
</pre></div>
<p>:RESULTS:</p>
<pre class="example">
Number of POS tags (number of 'states'): 45
View these POS tags (states)
['#', '$', "''", '(', ')', ',', '.', ':', 'CC', 'CD', 'DT', 'EX', 'FW', 'IN', 'JJ', 'JJR', 'JJS', 'LS', 'MD', 'NN', 'NNP', 'NNPS', 'NNS', 'PDT', 'POS', 'PRP', 'PRP$', 'RB', 'RBR', 'RBS', 'RP', 'SYM', 'TO', 'UH', 'VB', 'VBD', 'VBG', 'VBN', 'VBP', 'VBZ', 'WDT', 'WP', 'WP$', 'WRB', '``']
{'--s--'}
</pre>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"transition examples: "</span><span class="p">)</span>
<span class="n">expected</span> <span class="o">=</span> <span class="p">(((</span><span class="s1">'--s--'</span><span class="p">,</span> <span class="s1">'IN'</span><span class="p">),</span> <span class="mi">5050</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'IN'</span><span class="p">,</span> <span class="s1">'DT'</span><span class="p">),</span> <span class="mi">32364</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'DT'</span><span class="p">,</span> <span class="s1">'NNP'</span><span class="p">),</span> <span class="mi">9044</span><span class="p">))</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">example</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">transition_counts</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">3</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">example</span> <span class="o">==</span> <span class="n">expected</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</pre></div>
<pre class="example">
transition examples: 
(('--s--', 'IN'), 5050)
(('IN', 'DT'), 32364)
(('DT', 'NNP'), 9044)
</pre>
<div class="highlight">
<pre><span></span><span class="n">expected</span> <span class="o">=</span> <span class="p">(((</span><span class="s1">'DT'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">),</span> <span class="mi">721</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'NN'</span><span class="p">,</span> <span class="s1">'decrease'</span><span class="p">),</span> <span class="mi">7</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'NN'</span><span class="p">,</span> <span class="s1">'insider-trading'</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"emission examples: "</span><span class="p">)</span>
<span class="k">for</span> <span class="n">actual</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">emission_counts</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">200</span><span class="p">:</span><span class="mi">203</span><span class="p">],</span> <span class="n">expected</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">actual</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">expected</span>
</pre></div>
<pre class="example">
emission examples: 
(('DT', 'any'), 721)
(('NN', 'decrease'), 7)
(('NN', 'insider-trading'), 5)
</pre>
<div class="highlight">
<pre><span></span><span class="n">expected</span> <span class="o">=</span> <span class="p">(((</span><span class="s1">'RB'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">304</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'VB'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">20</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'RP'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">84</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'JJ'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">25</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'NN'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">29</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'VBP'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"ambiguous word example: "</span><span class="p">)</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">tup</span><span class="p">,</span> <span class="n">cnt</span> <span class="ow">in</span> <span class="n">emission_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'back'</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">cnt</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">expected</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">cnt</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
<pre class="example">
ambiguous word example: 
('RB', 'back') 304
('VB', 'back') 20
('RP', 'back') 84
('JJ', 'back') 25
('NN', 'back') 29
('VBP', 'back') 4
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org13046f8">
<h2 id="org13046f8">Bundle It Up</h2>
<div class="outline-text-2" id="text-org13046f8"></div>
<div class="outline-3" id="outline-container-org13bd408">
<h3 id="org13bd408">Imports</h3>
<div class="outline-text-3" id="text-org13bd408">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">Counter</span>
<span class="c1"># pypi</span>
<span class="kn">import</span> <span class="nn">attr</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org6c069ab">
<h3 id="org6c069ab">The Trainer</h3>
<div class="outline-text-3" id="text-org6c069ab">
<div class="highlight">
<pre><span></span><span class="nd">@attr</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">auto_attribs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TheTrainer</span><span class="p">:</span>
    <span class="sd">"""Trains the POS model</span>

<span class="sd">    Args:</span>
<span class="sd">     corpus: iterable of word, tag tuples</span>
<span class="sd">    """</span>
    <span class="n">corpus</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">_transition_counts</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_emission_counts</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_tag_counts</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span>
</pre></div>
</div>
<div class="outline-4" id="outline-container-org753a3f7">
<h4 id="org753a3f7">Transition Counts</h4>
<div class="outline-text-4" id="text-org753a3f7">
<p>This dictionary will be used to compute: \[ P(t_i |t_{i-1}) \]</p>
<p>This is the probability of a tag at position <i>i</i> given the tag at position <i>i-1</i>.</p>
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">transition_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""maps previous, next tags to counts"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transition_counts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transition_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">previous_tag</span> <span class="o">=</span> <span class="s2">"--s--"</span>
        <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corpus</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_transition_counts</span><span class="p">[(</span><span class="n">previous_tag</span><span class="p">,</span> <span class="n">tag</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">previous_tag</span> <span class="o">=</span> <span class="n">tag</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transition_counts</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org0921a16">
<h4 id="org0921a16">Emission Counts</h4>
<div class="outline-text-4" id="text-org0921a16">
<p>The second dictionary you will compute is the <code>emission_counts</code> dictionary. This dictionary will be used to compute:</p>
<p>\[ P(w_i|t_i) \]</p>
<p>In other words, you will use it to compute the probability of a word given its tag.</p>
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">emission_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""Maps tag, word pairs to counts"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_emission_counts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_emission_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span>
            <span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corpus</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_emission_counts</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgfcc442f">
<h4 id="orgfcc442f">Tag Counts</h4>
<div class="outline-text-4" id="text-orgfcc442f">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">tag_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""Count of tags"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_counts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tag_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">((</span><span class="n">tag</span> <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corpus</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_counts</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgdc4f89a">
<h3 id="orgdc4f89a">Test It Out</h3>
<div class="outline-text-3" id="text-orgdc4f89a">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">neurotic.nlp.parts_of_speech.training</span> <span class="kn">import</span> <span class="n">TheTrainer</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">TheTrainer</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">processed_training</span><span class="p">)</span>
</pre></div>
</div>
<div class="outline-4" id="outline-container-orge324530">
<h4 id="orge324530">Tag Counts</h4>
<div class="outline-text-4" id="text-orge324530">
<div class="highlight">
<pre><span></span><span class="n">states</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">tag_counts</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of POS tags (number of 'states'): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"View these POS tags (states)"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)</span> <span class="o">==</span> <span class="mi">46</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
<span class="n">expected_states</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'#'</span><span class="p">,</span> <span class="s1">'$'</span><span class="p">,</span> <span class="s2">"''"</span><span class="p">,</span> <span class="s1">'('</span><span class="p">,</span> <span class="s1">')'</span><span class="p">,</span> <span class="s1">','</span><span class="p">,</span> <span class="s1">'--s--'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">,</span> <span class="s1">':'</span><span class="p">,</span> <span class="s1">'CC'</span><span class="p">,</span> <span class="s1">'CD'</span><span class="p">,</span> <span class="s1">'DT'</span><span class="p">,</span> <span class="s1">'EX'</span><span class="p">,</span> <span class="s1">'FW'</span><span class="p">,</span> <span class="s1">'IN'</span><span class="p">,</span> <span class="s1">'JJ'</span><span class="p">,</span> <span class="s1">'JJR'</span><span class="p">,</span> <span class="s1">'JJS'</span><span class="p">,</span> <span class="s1">'LS'</span><span class="p">,</span> <span class="s1">'MD'</span><span class="p">,</span> <span class="s1">'NN'</span><span class="p">,</span> <span class="s1">'NNP'</span><span class="p">,</span> <span class="s1">'NNPS'</span><span class="p">,</span> <span class="s1">'NNS'</span><span class="p">,</span> <span class="s1">'PDT'</span><span class="p">,</span> <span class="s1">'POS'</span><span class="p">,</span> <span class="s1">'PRP'</span><span class="p">,</span> <span class="s1">'PRP$'</span><span class="p">,</span> <span class="s1">'RB'</span><span class="p">,</span> <span class="s1">'RBR'</span><span class="p">,</span> <span class="s1">'RBS'</span><span class="p">,</span> <span class="s1">'RP'</span><span class="p">,</span> <span class="s1">'SYM'</span><span class="p">,</span> <span class="s1">'TO'</span><span class="p">,</span> <span class="s1">'UH'</span><span class="p">,</span> <span class="s1">'VB'</span><span class="p">,</span> <span class="s1">'VBD'</span><span class="p">,</span> <span class="s1">'VBG'</span><span class="p">,</span> <span class="s1">'VBN'</span><span class="p">,</span> <span class="s1">'VBP'</span><span class="p">,</span> <span class="s1">'VBZ'</span><span class="p">,</span> <span class="s1">'WDT'</span><span class="p">,</span> <span class="s1">'WP'</span><span class="p">,</span> <span class="s1">'WP$'</span><span class="p">,</span> <span class="s1">'WRB'</span><span class="p">,</span> <span class="s1">'``'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">expected</span><span class="p">,</span> <span class="n">actual</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">expected_states</span><span class="p">,</span> <span class="n">states</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">expected</span> <span class="o">==</span> <span class="n">actual</span>
</pre></div>
<pre class="example">
Number of POS tags (number of 'states'): 46
View these POS tags (states)
['#', '$', "''", '(', ')', ',', '--s--', '.', ':', 'CC', 'CD', 'DT', 'EX', 'FW', 'IN', 'JJ', 'JJR', 'JJS', 'LS', 'MD', 'NN', 'NNP', 'NNPS', 'NNS', 'PDT', 'POS', 'PRP', 'PRP$', 'RB', 'RBR', 'RBS', 'RP', 'SYM', 'TO', 'UH', 'VB', 'VBD', 'VBG', 'VBN', 'VBP', 'VBZ', 'WDT', 'WP', 'WP$', 'WRB', '``']
</pre></div>
</div>
<div class="outline-4" id="outline-container-org2b9f049">
<h4 id="org2b9f049">Transition Counts</h4>
<div class="outline-text-4" id="text-org2b9f049">
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"transition examples: "</span><span class="p">)</span>
<span class="n">expected</span> <span class="o">=</span> <span class="p">(((</span><span class="s1">'--s--'</span><span class="p">,</span> <span class="s1">'IN'</span><span class="p">),</span> <span class="mi">5050</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'IN'</span><span class="p">,</span> <span class="s1">'DT'</span><span class="p">),</span> <span class="mi">32364</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'DT'</span><span class="p">,</span> <span class="s1">'NNP'</span><span class="p">),</span> <span class="mi">9044</span><span class="p">))</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">example</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">transition_counts</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">3</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">example</span> <span class="o">==</span> <span class="n">expected</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</pre></div>
<pre class="example">
transition examples: 
(('--s--', 'IN'), 5050)
(('IN', 'DT'), 32364)
(('DT', 'NNP'), 9044)
</pre></div>
</div>
<div class="outline-4" id="outline-container-org37a7d7b">
<h4 id="org37a7d7b">Emission Counts</h4>
<div class="outline-text-4" id="text-org37a7d7b">
<div class="highlight">
<pre><span></span><span class="n">expected</span> <span class="o">=</span> <span class="p">(((</span><span class="s1">'DT'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">),</span> <span class="mi">721</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'NN'</span><span class="p">,</span> <span class="s1">'decrease'</span><span class="p">),</span> <span class="mi">7</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'NN'</span><span class="p">,</span> <span class="s1">'insider-trading'</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"emission examples: "</span><span class="p">)</span>
<span class="k">for</span> <span class="n">actual</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">emission_counts</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">200</span><span class="p">:</span><span class="mi">203</span><span class="p">],</span> <span class="n">expected</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">actual</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">expected</span>
</pre></div>
<pre class="example">
emission examples: 
(('DT', 'any'), 721)
(('NN', 'decrease'), 7)
(('NN', 'insider-trading'), 5)
</pre></div>
</div>
<div class="outline-4" id="outline-container-org3d3a190">
<h4 id="org3d3a190">Ambiuguous Word Emission Counts</h4>
<div class="outline-text-4" id="text-org3d3a190">
<div class="highlight">
<pre><span></span><span class="n">expected</span> <span class="o">=</span> <span class="p">(((</span><span class="s1">'RB'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">304</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'VB'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">20</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'RP'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">84</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'JJ'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">25</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'NN'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">29</span><span class="p">),</span>
            <span class="p">((</span><span class="s1">'VBP'</span><span class="p">,</span> <span class="s1">'back'</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"ambiguous word example: "</span><span class="p">)</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">tag_word</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">trainer</span><span class="o">.</span><span class="n">emission_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">tag_word</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'back'</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tag_word</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">expected</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="n">tag_word</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
<pre class="example">
ambiguous word example: 
('RB', 'back') 304
('VB', 'back') 20
('RP', 'back') 84
('JJ', 'back') 25
('NN', 'back') 29
('VBP', 'back') 4
</pre></div>
</div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../categories/nlp/" rel="tag">nlp</a></li>
<li><a class="tag p-category" href="../../../categories/pos-tagging/" rel="tag">pos tagging</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../parts-of-speech-tagging-the-data/" rel="prev" title="Parts-of-Speech Tagging: The Data">Previous post</a></li>
<li class="next"><a href="../parts-of-speech-tagging-most-frequent-class-baseline/" rel="next" title="Parts-of-Speech Tagging: Most Frequent Class Baseline">Next post</a></li>
</ul>
</nav>
</aside>
<script async id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
<script type="text/x-mathjax-config">

        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']],},

        });
</script>
<link href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script>
<script>

    MathJax = {
        tex: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [['$$','$$'], ['\\[','\\]']],
            processEscapes: true,
            processEnvironments: true,
        }
    }
</script>
<link href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script></article>
<!--End of body content-->
<footer id="footer"><a href="https://creativecommons.org/licenses/by/4.0/" rel="license"><img alt="Creative Commons License" id="license-image" src="https://licensebuttons.net/l/by/4.0/80x15.png" style="border-width:0"></a>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0 International License</a>. <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
