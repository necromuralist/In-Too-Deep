<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Exploring the reviews dataset." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Exploring the Reviews Dataset | Neurotic Networking</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../../rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Neurotic-Networking/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/" rel="canonical"><!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../../site.webmanifest" rel="manifest">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<script async src="../../../assets/javascript/bokeh-1.3.4.min.js" type="text/javascript"></script>
<meta content="Cloistered Monkey" name="author">
<link href="/posts/nano/bike-sharing/bike-sharing-project-feedback/" rel="prev" title="Bike Sharing Project Feedback" type="text/html">
<link href="/posts/nano/sentiment_analysis/the-network-parts/" rel="next" title="The Network Parts" type="text/html">
<meta content="Neurotic Networking" property="og:site_name">
<meta content="Exploring the Reviews Dataset" property="og:title">
<meta content="https://necromuralist.github.io/Neurotic-Networking/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/" property="og:url">
<meta content="Exploring the reviews dataset." property="og:description">
<meta content="article" property="og:type">
<meta content="2018-11-11T14:25:48-08:00" property="article:published_time">
<meta content="exploration" property="article:tag">
<meta content="lecture" property="article:tag">
<meta content="sentiment analysis" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="https://necromuralist.github.io/Neurotic-Networking/"><span id="blog-title">Neurotic Networking</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="/archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="/categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="/rss.xml">RSS feed</a></li>
<li class="nav-item"><a class="nav-link" href="https://necromuralist.github.io/">Cloistered Monkey</a></li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/Neurotic-Networking/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href="/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/">Exploring the Reviews Dataset</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/" rel="bookmark"><time class="published dt-published" datetime="2018-11-11T14:25:48-08:00" itemprop="datePublished" title="2018-11-11 14:25">2018-11-11 14:25</time></a></p>
<p class="sourceline"><a class="sourcelink" href="/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/#org12f6473">Set Up</a></li>
<li><a href="/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/#org7a68b53">Lesson 1: Curate a Dataset</a></li>
<li><a href="/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/#orgdbf31c3">Develop a Predictive Theory</a></li>
<li><a href="/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/#org3fd079f">Quick Theory Validation</a></li>
<li><a href="/posts/nano/sentiment_analysis/exploring-the-reviews-dataset/#org632d6da">Pickling</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org12f6473">
<h2 id="org12f6473">Set Up</h2>
<div class="outline-text-2" id="text-org12f6473"></div>
<div class="outline-3" id="outline-container-org1117059">
<h3 id="org1117059">Imports</h3>
<div class="outline-text-3" id="text-org1117059"></div>
<div class="outline-4" id="outline-container-org48c6f3b">
<h4 id="org48c6f3b">Python</h4>
<div class="outline-text-4" id="text-org48c6f3b">
<div class="highlight">
<pre><span></span>from collections import Counter
import pickle
import textwrap
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org05c95df">
<h4 id="org05c95df">PyPi</h4>
<div class="outline-text-4" id="text-org05c95df">
<div class="highlight">
<pre><span></span>import numpy
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org95bd06d">
<h4 id="org95bd06d">This Project</h4>
<div class="outline-text-4" id="text-org95bd06d">
<div class="highlight">
<pre><span></span>from neurotic.tangles.data_paths import DataPath
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org7a68b53">
<h2 id="org7a68b53">Lesson 1: Curate a Dataset</h2>
<div class="outline-text-2" id="text-org7a68b53">
<p>The goal of this section is to become familiar with the data and perform any preprocessing that might be needed.</p>
</div>
<div class="outline-3" id="outline-container-org2a62f58">
<h3 id="org2a62f58">A Helper To Print</h3>
<div class="outline-text-3" id="text-org2a62f58">
<div class="highlight">
<pre><span></span>def pretty_print_review_and_label(index: int, up_to: int=80) -&gt; None:
    """Prints the label and review

    Args:
     index: the index of the review in the data set
     up_to: number of characters in the review to show
    """
    print("|{}|{}|".format(labels[index], reviews[index][:up_to] + "..."))
    return
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org48c1905">
<h3 id="org48c1905">The Reviews</h3>
<div class="outline-text-3" id="text-org48c1905">
<p>It's not really clear what he's doing here. I think he's stripping the newlines off of the reviews, so each review must be one line.</p>
<div class="highlight">
<pre><span></span>path = DataPath("reviews.txt")
with open(path.from_folder,'r') as reader:
    reviews = [line.rstrip() for line in reader]
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgc03b9c4">
<h3 id="orgc03b9c4">The Labels</h3>
<div class="outline-text-3" id="text-orgc03b9c4">
<p>A similar deal except casting the labels to upper case.</p>
<div class="highlight">
<pre><span></span>path = DataPath("labels.txt")
with open(path.from_folder,'r') as reader:
    labels = (line.rstrip() for line in reader)
    labels = [line.upper() for line in labels]
</pre></div>
<p><b>Note:</b> The data in <code>reviews.txt</code> we're using has already been preprocessed a bit and contains only lower case characters. If we were working from raw data, where we didn't know it was all lower case, we would want to add a step here to convert it. That's so we treat different variations of the same word, like `The`, `the`, and `THE`, all the same way.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org7388ff8">
<h3 id="org7388ff8">How many reviews do we have?</h3>
<div class="outline-text-3" id="text-org7388ff8">
<div class="highlight">
<pre><span></span>print("{:,}".format(len(reviews)))
</pre></div>
<pre class="example">
25,000

</pre></div>
</div>
<div class="outline-3" id="outline-container-org3fbfa44">
<h3 id="org3fbfa44">What does a review look like?</h3>
<div class="outline-text-3" id="text-org3fbfa44">
<div class="highlight">
<pre><span></span>print("\n".join(textwrap.wrap(reviews[0], width=80)))
</pre></div>
<pre class="example">
bromwell high is a cartoon comedy . it ran at the same time as some other
programs about school life  such as  teachers  . my   years in the teaching
profession lead me to believe that bromwell high  s satire is much closer to
reality than is  teachers  . the scramble to survive financially  the insightful
students who can see right through their pathetic teachers  pomp  the pettiness
of the whole situation  all remind me of the schools i knew and their students .
when i saw the episode in which a student repeatedly tried to burn down the
school  i immediately recalled . . . . . . . . . at . . . . . . . . . . high . a
classic line inspector i  m here to sack one of your teachers . student welcome
to bromwell high . i expect that many adults of my age think that bromwell high
is far fetched . what a pity that it isn  t
</pre>
<p>Kind of odd looking. It looks like the pre-processor did some bad things.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org989b5c2">
<h3 id="org989b5c2">What does the label for that review look like?</h3>
<div class="outline-text-3" id="text-org989b5c2">
<div class="highlight">
<pre><span></span>print(labels[0])
</pre></div>
<pre class="example">
POSITIVE

</pre></div>
</div>
<div class="outline-3" id="outline-container-org0d651b6">
<h3 id="org0d651b6">What are the labels available?</h3>
<div class="outline-text-3" id="text-org0d651b6">
<p>At this point we don't have pandas loaded, so I'll just use a set to look at the labels.</p>
<div class="highlight">
<pre><span></span>print(set(labels))
</pre></div>
<pre class="example">
{'NEGATIVE', 'POSITIVE'}

</pre>
<p>So there are two labels - "NEGATIVE" and "POSITIVE".</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgdbf31c3">
<h2 id="orgdbf31c3">Develop a Predictive Theory</h2>
<div class="outline-text-2" id="text-orgdbf31c3">
<p>The previous section gave us a rough idea of what's in the data set. Now we want to make a guess as to what the labels mean - why is a review labled POSITIVE or NEGATIVE?</p>
<div class="highlight">
<pre><span></span>print("|labels.txt| reviews.txt|")
print("|-+-|")
indices = (2137, 12816, 6267, 21934, 5297, 4998)
for index in indices:
    pretty_print_review_and_label(index)
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">labels.txt</th>
<th class="org-left" scope="col">reviews.txt</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">NEGATIVE</td>
<td class="org-left">this movie is terrible but it has some good effects ….</td>
</tr>
<tr>
<td class="org-left">POSITIVE</td>
<td class="org-left">adrian pasdar is excellent is this film . he makes a fascinating woman ….</td>
</tr>
<tr>
<td class="org-left">NEGATIVE</td>
<td class="org-left">comment this movie is impossible . is terrible very improbable bad interpretat…</td>
</tr>
<tr>
<td class="org-left">POSITIVE</td>
<td class="org-left">excellent episode movie ala pulp fiction . days suicides . it doesnt get more…</td>
</tr>
<tr>
<td class="org-left">NEGATIVE</td>
<td class="org-left">if you haven t seen this it s terrible . it is pure trash . i saw this about …</td>
</tr>
<tr>
<td class="org-left">POSITIVE</td>
<td class="org-left">this schiffer guy is a real genius the movie is of excellent quality and both e…</td>
</tr>
</tbody>
</table>
<p>If you look at the negative reviews, they all have the work 'terrible' in them, and the positives all have the workd 'excellent' in them. The theory then, is that the labels are based on whether a review has a key-word in it that makes it either positive or negative.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org3fd079f">
<h2 id="org3fd079f">Quick Theory Validation</h2>
<div class="outline-text-2" id="text-org3fd079f">
<p>In this section we're going to test our theory that key-words identify whether a review is positive or negative using the <a href="https://docs.python.org/2/library/collections.html#collections.Counter">Counter</a> class and the <a href="https://docs.scipy.org/doc/numpy/reference/">numpy</a> library.</p>
</div>
<div class="outline-3" id="outline-container-orgd2d871c">
<h3 id="orgd2d871c">Word Counter</h3>
<div class="outline-text-3" id="text-orgd2d871c">
<p>We'll create three <code>Counter</code> objects, one for words from postive reviews, one for words from negative reviews, and one for all the words.</p>
<div class="highlight">
<pre><span></span>positive_counts = Counter()
negative_counts = Counter()
total_counts = Counter()
</pre></div>
<p>Examine all the reviews. For each word in a positive review, increase the count for that word in both your positive counter and the total words counter; likewise, for each word in a negative review, increase the count for that word in both your negative counter and the total words counter.</p>
<p><b>Note:</b> Throughout these projects, you should use `split(' ')` to divide a piece of text (such as a review) into individual words. If you use `split()` instead, you'll get slightly different results than what the videos and solutions show.</p>
<p>The classifications in the <code>labels</code> list.</p>
<div class="highlight">
<pre><span></span>class Classification:
    positive = "POSITIVE"
    negative = "NEGATIVE"
</pre></div>
<p>What we are splitting on.</p>
<div class="highlight">
<pre><span></span>class Tokens:
    splitter = " "
</pre></div>
<div class="highlight">
<pre><span></span>with DataPath("labels.pkl").from_folder.open("rb") as reader:
    labels = pickle.load(reader)
</pre></div>
<div class="highlight">
<pre><span></span>for label, review in zip(labels, reviews):
    tokens = review.split(Tokens.splitter)
    total_counts.update(tokens)

    if label == Classification.positive:
        positive_counts.update(tokens)        
    else:
        negative_counts.update(tokens)
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org9c36d84">
<h3 id="org9c36d84">Most Common Words</h3>
<div class="outline-text-3" id="text-org9c36d84">
<p>Run the following two cells to list the words used in positive reviews and negative reviews, respectively, ordered from most to least commonly used.</p>
<p>Examine the counts of the most common words in positive reviews</p>
<div class="highlight">
<pre><span></span>print("|Token| Count|")
print("|-+-|")
for token, count in positive_counts.most_common(10):
    print("|{}|{:,}|".format(token, count))
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Token</th>
<th class="org-left" scope="col">Count</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">&nbsp;</td>
<td class="org-left">518,327</td>
</tr>
<tr>
<td class="org-left">the</td>
<td class="org-left">173,324</td>
</tr>
<tr>
<td class="org-left">.</td>
<td class="org-left">159,654</td>
</tr>
<tr>
<td class="org-left">and</td>
<td class="org-left">89,722</td>
</tr>
<tr>
<td class="org-left">a</td>
<td class="org-left">83,688</td>
</tr>
<tr>
<td class="org-left">of</td>
<td class="org-left">76,855</td>
</tr>
<tr>
<td class="org-left">to</td>
<td class="org-left">66,746</td>
</tr>
<tr>
<td class="org-left">is</td>
<td class="org-left">57,245</td>
</tr>
<tr>
<td class="org-left">in</td>
<td class="org-left">50,215</td>
</tr>
<tr>
<td class="org-left">br</td>
<td class="org-left">49,235</td>
</tr>
</tbody>
</table>
<p>So, we probably don't want most of the most common tokens.</p>
<p>Examine the counts of the most common words in negative reviews</p>
<div class="highlight">
<pre><span></span>print("|Token| Count|")
print("|-+-|")
for token, count in negative_counts.most_common(10):
    print("|{}|{:,}|".format(token, count))
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Token</th>
<th class="org-left" scope="col">Count</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">&nbsp;</td>
<td class="org-left">531,016</td>
</tr>
<tr>
<td class="org-left">.</td>
<td class="org-left">167,538</td>
</tr>
<tr>
<td class="org-left">the</td>
<td class="org-left">163,389</td>
</tr>
<tr>
<td class="org-left">a</td>
<td class="org-left">79,321</td>
</tr>
<tr>
<td class="org-left">and</td>
<td class="org-left">74,385</td>
</tr>
<tr>
<td class="org-left">of</td>
<td class="org-left">69,009</td>
</tr>
<tr>
<td class="org-left">to</td>
<td class="org-left">68,974</td>
</tr>
<tr>
<td class="org-left">br</td>
<td class="org-left">52,637</td>
</tr>
<tr>
<td class="org-left">is</td>
<td class="org-left">50,083</td>
</tr>
<tr>
<td class="org-left">it</td>
<td class="org-left">48,327</td>
</tr>
</tbody>
</table>
<p>As you can see, common words like "the" appear very often in both positive and negative reviews. Instead of finding the most common words in positive or negative reviews, what you really want are the words found in positive reviews more often than in negative reviews, and vice versa. To accomplish this, you'll need to calculate the <b>ratios</b> of word usage between positive and negative reviews.</p>
<p>Check all the words you've seen and calculate the ratio of postive to negative uses and store that ratio in <code>pos_neg_ratios</code>.</p>
<p>Hint: the positive-to-negative ratio for a given word can be calculated with `positive_counts[word] / float(negative_counts[word]+1)`. Notice the `+1` in the denominator –&nbsp;that ensures we don't divide by zero for words that are only seen in positive reviews.</p>
<p>Create a Counter object to store positive/negative ratios</p>
<div class="highlight">
<pre><span></span>pos_neg_ratios = Counter()
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgbbb8e48">
<h3 id="orgbbb8e48">Positive to negative ratios</h3>
<div class="outline-text-3" id="text-orgbbb8e48">
<p>Calculate the ratios of positive and negative uses of the most common words</p>
<div class="highlight">
<pre><span></span>ratios = {element: positive_counts[element]/(negative_counts[element] + 1)
          for element in total_counts}
pos_neg_ratios.update(ratios)
</pre></div>
<div class="highlight">
<pre><span></span>with DataPath("pos_neg_ratios.pkl",
              check_exists=False).from_folder.open("wb") as writer:
    pickle.dump(pos_neg_ratios, writer)
</pre></div>
<p>Examine the ratios you've calculated for a few words:</p>
<div class="highlight">
<pre><span></span>print("Pos-to-neg ratio for 'the' = {:.2f}".format(pos_neg_ratios["the"]))
print("Pos-to-neg ratio for 'amazing' = {:.2f}".format(pos_neg_ratios["amazing"]))
print("Pos-to-neg ratio for 'terrible' = {:.2f}".format(pos_neg_ratios["terrible"]))
</pre></div>
<pre class="example">
Pos-to-neg ratio for 'the' = 1.06
Pos-to-neg ratio for 'amazing' = 4.02
Pos-to-neg ratio for 'terrible' = 0.18

</pre>
<p>Looking closely at the values you just calculated, we see the following:</p>
<ul class="org-ul">
<li>Words that you would expect to see more often in positive reviews - like "amazing" - have a ratio greater than 1. The more skewed a word is toward postive, the farther from 1 its positive-to-negative ratio will be.</li>
<li>Words that you would expect to see more often in negative reviews - like "terrible" - have positive values that are less than 1. The more skewed a word is toward negative, the closer to zero its positive-to-negative ratio will be.</li>
<li>Neutral words, which don't really convey any sentiment because you would expect to see them in all sorts of reviews – like "the" – have values very close to 1. A perfectly neutral word –&nbsp;one that was used in exactly the same number of positive reviews as negative reviews – would be almost exactly 1. The `+1` we suggested you add to the denominator slightly biases words toward negative, but it won't matter because it will be a tiny bias and later we'll be ignoring words that are too close to neutral anyway.</li>
</ul>
<p>Ok, the ratios tell us which words are used more often in postive or negative reviews, but the specific values we've calculated are a bit difficult to work with. A very positive word like "amazing" has a value above 4, whereas a very negative word like "terrible" has a value around 0.18. Those values aren't easy to compare for a couple of reasons:</p>
<ul class="org-ul">
<li>Right now, 1 is considered neutral, but the absolute value of the postive-to-negative ratios of very postive words is larger than the absolute value of the ratios for the very negative words. So there is no way to directly compare two numbers and see if one word conveys the same magnitude of positive sentiment as another word conveys negative sentiment. So we should center all the values around netural so the absolute value from neutral of the postive-to-negative ratio for a word would indicate how much sentiment (positive or negative) that word conveys.</li>
</ul>
<p><i>When comparing absolute values it's easier to do that around zero than one.</i></p>
<p>To fix these issues, we'll convert all of our ratios to new values using logarithms.</p>
<p>Go through all the ratios you calculated and convert them to logarithms. (i.e. use `np.log(ratio)`)</p>
<p>In the end, extremely positive and extremely negative words will have positive-to-negative ratios with similar magnitudes but opposite signs. Note that you have to create a new counter - the <code>update</code> method adds the new value to the previous values.</p>
<div class="highlight">
<pre><span></span>log_ratios = {}
for token, ratio in pos_neg_ratios.items():
    if ratio &gt; 1:
        log_ratios[token] = numpy.log(ratio)
    else:
        log_ratios[token] = -numpy.log(1/(ratio + 0.01))
positive_negative_log_ratios = Counter()
positive_negative_log_ratios.update(log_ratios)
</pre></div>
<p>Examine the new ratios you've calculated for the same words from before:</p>
<div class="highlight">
<pre><span></span>print("Pos-to-neg ratio for 'the' = {:.2f}".format(positive_negative_log_ratios["the"]))
print("Pos-to-neg ratio for 'amazing' = {:.2f}".format(positive_negative_log_ratios["amazing"]))
print("Pos-to-neg ratio for 'terrible' = {:.2f}".format(positive_negative_log_ratios["terrible"]))
</pre></div>
<pre class="example">
Pos-to-neg ratio for 'the' = 0.06
Pos-to-neg ratio for 'amazing' = 1.39
Pos-to-neg ratio for 'terrible' = -1.67

</pre>
<div class="highlight">
<pre><span></span>with DataPath("pos_neg_log_ratios.pkl",
              check_exists=False).from_folder.open("wb") as writer:
    pickle.dump(positive_negative_log_ratios, writer)
</pre></div>
<p>If everything worked, now you should see neutral words with values close to zero. In this case, "the" is near zero but slightly positive, so it was probably used in more positive reviews than negative reviews. But look at "amazing"'s ratio - it's above <code>1</code>, showing it is clearly a word with positive sentiment. And "terrible" has a similar score, but in the opposite direction, so it's below <code>-1</code>. It's now clear that both of these words are associated with specific, opposing sentiments.</p>
<p>Now run the following cells to see more ratios.</p>
<p>The first cell displays all the words, ordered by how associated they are with postive reviews. (Your notebook will most likely truncate the output so you won't actually see <b>all</b> the words in the list.)</p>
<p>The second cell displays the 30 words most associated with negative reviews by reversing the order of the first list and then looking at the first 30 words. (If you want the second cell to display all the words, ordered by how associated they are with negative reviews, you could just write `reversed(pos_neg_ratios.most_common())`.)</p>
<p>You should continue to see values similar to the earlier ones we checked –&nbsp;neutral words will be close to `0`, words will get more positive as their ratios approach and go above `1`, and words will get more negative as their ratios approach and go below `-1`. That's why we decided to use the logs instead of the raw ratios.</p>
<p>Here are the words most frequently seen in a review with a "POSITIVE" label.</p>
<div class="highlight">
<pre><span></span>print("|Token|Log Ratio|")
print("|-+-|")
for token, ratio in positive_negative_log_ratios.most_common(10):
    print("|{}|{:.2f}|".format(token, ratio))
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Token</th>
<th class="org-right" scope="col">Log Ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">edie</td>
<td class="org-right">4.69</td>
</tr>
<tr>
<td class="org-left">antwone</td>
<td class="org-right">4.48</td>
</tr>
<tr>
<td class="org-left">din</td>
<td class="org-right">4.41</td>
</tr>
<tr>
<td class="org-left">gunga</td>
<td class="org-right">4.19</td>
</tr>
<tr>
<td class="org-left">goldsworthy</td>
<td class="org-right">4.17</td>
</tr>
<tr>
<td class="org-left">gypo</td>
<td class="org-right">4.09</td>
</tr>
<tr>
<td class="org-left">yokai</td>
<td class="org-right">4.09</td>
</tr>
<tr>
<td class="org-left">paulie</td>
<td class="org-right">4.08</td>
</tr>
<tr>
<td class="org-left">visconti</td>
<td class="org-right">3.93</td>
</tr>
<tr>
<td class="org-left">flavia</td>
<td class="org-right">3.93</td>
</tr>
</tbody>
</table>
<p>Ummm… okay.</p>
<div class="highlight">
<pre><span></span>print(positive_counts["edie"])
print(negative_counts["edie"])
</pre></div>
<pre class="example">
109
0

</pre>
<p>So the ones that are most positive appeared in the positive but not in the negative.</p>
<p>Here are the words most frequently seen in a review with a "NEGATIVE" label. The python slice notation is <code>list-name[first to include: first to exclude: step ]</code>.</p>
<div class="highlight">
<pre><span></span>print("|Token|Log Ratio|")
print("|-+-|")
for token, ratio in positive_negative_log_ratios.most_common()[:-11:-1]:
    print("|{}|{:.2f}|".format(token, ratio))
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Token</th>
<th class="org-right" scope="col">Log Ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">whelk</td>
<td class="org-right">-4.61</td>
</tr>
<tr>
<td class="org-left">pressurized</td>
<td class="org-right">-4.61</td>
</tr>
<tr>
<td class="org-left">bellwood</td>
<td class="org-right">-4.61</td>
</tr>
<tr>
<td class="org-left">mwuhahahaa</td>
<td class="org-right">-4.61</td>
</tr>
<tr>
<td class="org-left">insulation</td>
<td class="org-right">-4.61</td>
</tr>
<tr>
<td class="org-left">hoodies</td>
<td class="org-right">-4.61</td>
</tr>
<tr>
<td class="org-left">yaks</td>
<td class="org-right">-4.61</td>
</tr>
<tr>
<td class="org-left">raksha</td>
<td class="org-right">-4.61</td>
</tr>
<tr>
<td class="org-left">deamon</td>
<td class="org-right">-4.61</td>
</tr>
<tr>
<td class="org-left">ziller</td>
<td class="org-right">-4.61</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span>print(positive_counts["whelk"])
print(negative_counts["whelk"])
</pre></div>
<pre class="example">
0
1

</pre>
<p>And the most negative counts just didn't appear in the positive counts, even if they only appeared once in the negative counts.</p>
<p>As with the positive reviews, it's actually hard to figure out exactly what the most common tokens for negative reviews are.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgd7b15f5">
<h3 id="orgd7b15f5">Did our theory work?</h3>
<div class="outline-text-3" id="text-orgd7b15f5">
<p>Our theory was that key-words identify whether a review is positive or negative. There is some evidence for this, but really, it's not obvious that this is the case in general.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org632d6da">
<h2 id="org632d6da">Pickling</h2>
<div class="outline-text-2" id="text-org632d6da">
<p>Since the other posts in this section re-use some of this stuff it might make sense to pickle them.</p>
<div class="highlight">
<pre><span></span>with DataPath("total_counts.pkl", check_exists=False).from_folder.open("wb") as writer:
    pickle.dump(total_counts, writer)
</pre></div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="/categories/exploration/" rel="tag">exploration</a></li>
<li><a class="tag p-category" href="/categories/lecture/" rel="tag">lecture</a></li>
<li><a class="tag p-category" href="/categories/sentiment-analysis/" rel="tag">sentiment analysis</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="/posts/nano/bike-sharing/bike-sharing-project-feedback/" rel="prev" title="Bike Sharing Project Feedback">Previous post</a></li>
<li class="next"><a href="/posts/nano/sentiment_analysis/the-network-parts/" rel="next" title="The Network Parts">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Contents © 2020 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="/assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script> 
</body>
</html>
