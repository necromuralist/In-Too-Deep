<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Implementation portion for the BikeSharing project." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Bike Sharing Project Answers | Neurotic Networking</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Neurotic-Networking/posts/nano/bike-sharing/bike-sharing-project-answers/" rel="canonical"><!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../the-bike-sharing-project/" rel="prev" title="The Bike Sharing Project" type="text/html">
<link href="../../../notes/reading-list/" rel="next" title="Reading List" type="text/html">
<meta content="Neurotic Networking" property="og:site_name">
<meta content="Bike Sharing Project Answers" property="og:title">
<meta content="https://necromuralist.github.io/Neurotic-Networking/posts/nano/bike-sharing/bike-sharing-project-answers/" property="og:url">
<meta content="Implementation portion for the BikeSharing project." property="og:description">
<meta content="article" property="og:type">
<meta content="2018-10-30T15:31:25-07:00" property="article:published_time">
<meta content="neural networks" property="article:tag">
<meta content="project" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../../../"><span id="blog-title">Neurotic Networking</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../../rss.xml">RSS feed</a></li>
<li class="nav-item"><a class="nav-link" href="https://necromuralist.github.io/">Cloistered Monkey</a></li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/Neurotic-Networking/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Bike Sharing Project Answers</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2018-10-30T15:31:25-07:00" itemprop="datePublished" title="2018-10-30 15:31">2018-10-30 15:31</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org82c8dbf">Introduction</a></li>
<li><a href="#org18b0a1c">Imports</a></li>
<li><a href="#org90b3ce1">The Neural Network</a></li>
<li><a href="#orgc4341e9">The Hyper Parameters</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org82c8dbf">
<h2 id="org82c8dbf">Introduction</h2>
<div class="outline-text-2" id="text-org82c8dbf">
<p>The Bike Sharing Project uses a neural network to predict daily ridership for a bike sharing service. The code is split into two parts - a jupyter notebook that you work with and a python file (<code>my_answers.py</code>) where you put the parts of the code that isn't provided. This creates the <code>my_answer.py</code> file.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org18b0a1c">
<h2 id="org18b0a1c">Imports</h2>
<div class="outline-text-2" id="text-org18b0a1c">
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org90b3ce1">
<h2 id="org90b3ce1">The Neural Network</h2>
<div class="outline-text-2" id="text-org90b3ce1">
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">NeuralNetwork</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""Implementation of a neural network with one hidden layer</span>

<span class="sd">    Args:</span>
<span class="sd">     input_nodes: number of input nodes</span>
<span class="sd">     hidden_nodes: number of hidden nodes</span>
<span class="sd">     output_nodes: number of output_nodes</span>
<span class="sd">     learning_rate: rate at which to update the weights</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_nodes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hidden_nodes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">output_nodes</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
                 <span class="n">learning_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Set number of nodes in input, hidden and output layers.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_nodes</span> <span class="o">=</span> <span class="n">input_nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_nodes</span> <span class="o">=</span> <span class="n">hidden_nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_nodes</span> <span class="o">=</span> <span class="n">output_nodes</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>

        <span class="c1"># Initialize weights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weights_input_to_hidden</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weights_hidden_to_output</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-orgc938c85">
<h3 id="orgc938c85">Input To Hidden Weights</h3>
<div class="outline-text-3" id="text-orgc938c85">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">weights_input_to_hidden</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">"""Array of weights from input layer to the hidden layer"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weights_input_to_hidden</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weights_input_to_hidden</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
            <span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_nodes</span><span class="o">**-</span><span class="mf">0.5</span><span class="p">,</span> 
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_nodes</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weights_input_to_hidden</span>
</pre></div>
<p>The unit-test tries to set the weights so we need a setter.</p>
<div class="highlight">
<pre><span></span><span class="nd">@weights_input_to_hidden</span><span class="o">.</span><span class="n">setter</span>
<span class="k">def</span> <span class="nf">weights_input_to_hidden</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Sets the weights"""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_weights_input_to_hidden</span> <span class="o">=</span> <span class="n">weights</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgec1e610">
<h3 id="orgec1e610">Hidden To Output Weights</h3>
<div class="outline-text-3" id="text-orgec1e610">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">weights_hidden_to_output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""Array of weights for edges from hidden layer to output"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weights_hidden_to_output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weights_hidden_to_output</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
            <span class="mf">0.0</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hidden_nodes</span><span class="o">**-</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_nodes</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weights_hidden_to_output</span>
</pre></div>
<p>Once again, this is for the unit-testing.</p>
<div class="highlight">
<pre><span></span><span class="nd">@weights_hidden_to_output</span><span class="o">.</span><span class="n">setter</span>
<span class="k">def</span> <span class="nf">weights_hidden_to_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""sets the weights for edges from hidden layer to output"""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_weights_hidden_to_output</span> <span class="o">=</span> <span class="n">weights</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org02d3f7c">
<h3 id="org02d3f7c">Activation Function</h3>
<div class="outline-text-3" id="text-org02d3f7c">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">activation_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">"""A pass-through to the sigmoid"""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgee0d939">
<h3 id="orgee0d939">Sigmoid</h3>
<div class="outline-text-3" id="text-orgee0d939">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">"""Calculates the sigmoid of the value"""</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">value</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org638b6f3">
<h3 id="org638b6f3">Train</h3>
<div class="outline-text-3" id="text-org638b6f3">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
    <span class="sd">''' Train the network on batch of features and targets. </span>

<span class="sd">       Arguments</span>
<span class="sd">       ---------</span>

<span class="sd">       features: 2D array, each row is one data record, each column is a feature</span>
<span class="sd">       targets: 1D array of target values</span>

<span class="sd">    '''</span>
    <span class="n">n_records</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">delta_weights_i_h</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights_input_to_hidden</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">delta_weights_h_o</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights_hidden_to_output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> 
   <span class="k">for</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>            
        <span class="n">final_outputs</span><span class="p">,</span> <span class="n">hidden_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward_pass_train</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="c1"># Implement the backpropagation function below</span>
        <span class="n">delta_weights_i_h</span><span class="p">,</span> <span class="n">delta_weights_h_o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backpropagation</span><span class="p">(</span>
            <span class="n">final_outputs</span><span class="p">,</span> <span class="n">hidden_outputs</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
            <span class="n">delta_weights_i_h</span><span class="p">,</span> <span class="n">delta_weights_h_o</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_weights</span><span class="p">(</span><span class="n">delta_weights_i_h</span><span class="p">,</span> <span class="n">delta_weights_h_o</span><span class="p">,</span> <span class="n">n_records</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org8cf3c44">
<h3 id="org8cf3c44">Forward Pass Train</h3>
<div class="outline-text-3" id="text-org8cf3c44">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">forward_pass_train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
    <span class="sd">''' Implement forward pass here </span>

<span class="sd">       Arguments</span>
<span class="sd">       ---------</span>
<span class="sd">       X: features batch</span>

<span class="sd">    '''</span>
    <span class="n">hidden_inputs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights_input_to_hidden</span><span class="p">)</span>
    <span class="n">hidden_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation_function</span><span class="p">(</span><span class="n">hidden_inputs</span><span class="p">)</span>

    <span class="n">final_inputs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">hidden_outputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights_hidden_to_output</span><span class="p">)</span>
    <span class="n">final_outputs</span> <span class="o">=</span> <span class="n">final_inputs</span>
    <span class="k">return</span> <span class="n">final_outputs</span><span class="p">,</span> <span class="n">hidden_outputs</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org35335a2">
<h3 id="org35335a2">Back Propagation</h3>
<div class="outline-text-3" id="text-org35335a2">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">backpropagation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">final_outputs</span><span class="p">,</span> <span class="n">hidden_outputs</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">delta_weights_i_h</span><span class="p">,</span> <span class="n">delta_weights_h_o</span><span class="p">):</span>
    <span class="sd">''' Implement backpropagation</span>

<span class="sd">       Arguments</span>
<span class="sd">       ---------</span>
<span class="sd">       final_outputs: output from forward pass</span>
<span class="sd">       y: target (i.e. label) batch</span>
<span class="sd">       delta_weights_i_h: change in weights from input to hidden layers</span>
<span class="sd">       delta_weights_h_o: change in weights from hidden to output layers</span>

<span class="sd">    '''</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">final_outputs</span> <span class="o">-</span> <span class="n">y</span>

    <span class="n">hidden_error</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights_hidden_to_output</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

    <span class="n">output_error_term</span> <span class="o">=</span> <span class="n">error</span>

    <span class="n">hidden_error_term</span> <span class="o">=</span> <span class="n">hidden_error</span> <span class="o">*</span> <span class="n">hidden_outputs</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">hidden_outputs</span><span class="p">)</span>

    <span class="n">delta_weights_i_h</span> <span class="o">+=</span> <span class="o">-</span><span class="n">hidden_error_term</span> <span class="o">*</span> <span class="n">X</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="n">delta_weights_h_o</span> <span class="o">+=</span> <span class="o">-</span><span class="n">output_error_term</span> <span class="o">*</span> <span class="n">hidden_outputs</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">delta_weights_i_h</span><span class="p">,</span> <span class="n">delta_weights_h_o</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgbac8978">
<h3 id="orgbac8978">Update Weights</h3>
<div class="outline-text-3" id="text-orgbac8978">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">update_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta_weights_i_h</span><span class="p">,</span> <span class="n">delta_weights_h_o</span><span class="p">,</span> <span class="n">n_records</span><span class="p">):</span>
    <span class="sd">''' Update weights on gradient descent step</span>

<span class="sd">       Arguments</span>
<span class="sd">       ---------</span>
<span class="sd">       delta_weights_i_h: change in weights from input to hidden layers</span>
<span class="sd">       delta_weights_h_o: change in weights from hidden to output layers</span>
<span class="sd">       n_records: number of records</span>

<span class="sd">    '''</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weights_hidden_to_output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_weights_h_o</span><span class="o">/</span><span class="n">n_records</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weights_input_to_hidden</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_weights_i_h</span><span class="o">/</span><span class="n">n_records</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgd9692e8">
<h3 id="orgd9692e8">Run</h3>
<div class="outline-text-3" id="text-orgd9692e8">
<p><b>Warning:</b> The MSE function defined in the jupyter notebook won't work if you use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html">numpy.dot</a> instead of <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.matmul.html">numpy.matmul</a>. You can make it work by passing in <code>axis=1</code> to <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.mean.html">numpy.mean</a> but I don't think you're allowed to change the things in the jupyter notebook.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
    <span class="sd">''' Run a forward pass through the network with input features </span>

<span class="sd">       Arguments</span>
<span class="sd">       ---------</span>
<span class="sd">       features: 1D array of feature values</span>
<span class="sd">    '''</span>

    <span class="n">hidden_inputs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights_input_to_hidden</span><span class="p">)</span>
    <span class="n">hidden_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation_function</span><span class="p">(</span><span class="n">hidden_inputs</span><span class="p">)</span> 

    <span class="n">final_inputs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">hidden_outputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights_hidden_to_output</span><span class="p">)</span>
    <span class="n">final_outputs</span> <span class="o">=</span> <span class="n">final_inputs</span>        
    <span class="k">return</span> <span class="n">final_outputs</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgc4341e9">
<h2 id="orgc4341e9">The Hyper Parameters</h2>
<div class="outline-text-2" id="text-orgc4341e9">
<div class="highlight">
<pre><span></span><span class="n">iterations</span> <span class="o">=</span> <span class="mi">7500</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">hidden_nodes</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">output_nodes</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../../categories/neural-networks/" rel="tag">neural networks</a></li>
<li><a class="tag p-category" href="../../../../categories/project/" rel="tag">project</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../the-bike-sharing-project/" rel="prev" title="The Bike Sharing Project">Previous post</a></li>
<li class="next"><a href="../../../notes/reading-list/" rel="next" title="Reading List">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer"><a href="http://creativecommons.org/licenses/by/4.0/" rel="license"><img alt="Creative Commons License" id="license-image" src="https://i.creativecommons.org/l/by/4.0/80x15.png" style="border-width:0"></a>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0 International License</a>. <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
