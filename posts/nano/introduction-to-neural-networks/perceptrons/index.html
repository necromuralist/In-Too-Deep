<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Notes on the Perceptron section of Udacity's /Introduction to Neural Networks/." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Perceptrons | Neurotic Networking</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Neurotic-Networking/posts/nano/introduction-to-neural-networks/perceptrons/" rel="canonical"><!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../introduction-to-neural-networks/" rel="prev" title="Introduction to Neural Networks" type="text/html">
<link href="../the-perceptron-algorithm/" rel="next" title="The Perceptron Algorithm" type="text/html">
<meta content="Neurotic Networking" property="og:site_name">
<meta content="Perceptrons" property="og:title">
<meta content="https://necromuralist.github.io/Neurotic-Networking/posts/nano/introduction-to-neural-networks/perceptrons/" property="og:url">
<meta content="Notes on the Perceptron section of Udacity's /Introduction to Neural Networks/." property="og:description">
<meta content="article" property="og:type">
<meta content="2018-10-20T17:43:47-07:00" property="article:published_time">
<meta content="lecture" property="article:tag">
<meta content="neural networks" property="article:tag">
<meta content="perceptrons" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../../../"><span id="blog-title">Neurotic Networking</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../../rss.xml">RSS feed</a></li>
<li class="nav-item"><a class="nav-link" href="https://necromuralist.github.io/">Cloistered Monkey</a></li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/Neurotic-Networking/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Perceptrons</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2018-10-20T17:43:47-07:00" itemprop="datePublished" title="2018-10-20 17:43">2018-10-20 17:43</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgad2f640">Imports</a></li>
<li><a href="#orge7be0ad">Setup the Plotting</a></li>
<li><a href="#orgae4e287">What is a Perceptron?</a></li>
<li><a href="#org2ae1d0b">Why are these called neural networks?</a></li>
<li><a href="#org0526d7b">Can perceptrons do logic?</a></li>
<li><a href="#org076ad27">That's a lot of work to get an XOR, how are we going to classify images like this?</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgad2f640">
<h2 id="orgad2f640">Imports</h2>
<div class="outline-text-2" id="text-orgad2f640"></div>
<div class="outline-3" id="outline-container-orgdcf15b8">
<h3 id="orgdcf15b8">From PyPi</h3>
<div class="outline-text-3" id="text-orgdcf15b8">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Digraph</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pyplot</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orge7be0ad">
<h2 id="orge7be0ad">Setup the Plotting</h2>
<div class="outline-text-2" id="text-orge7be0ad">
<div class="highlight">
<pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">"whitegrid"</span><span class="p">)</span>
<span class="n">FIGURE_SIZE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgae4e287">
<h2 id="orgae4e287">What is a Perceptron?</h2>
<div class="outline-text-2" id="text-orgae4e287">
<p>A perceptron is a model based on the neuron that works as a linear classifier.</p>
<p>Our acceptance model from the previous post:</p>
<p>\[ 2x_1 + x_2 - 18 = 0 \]</p>
<p>Would be modeled by something like this.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Perceptron"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s2">"rankdir"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"Test"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"Grade"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"-18"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"Label"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"2"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/perceptron.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org6a5a849">
<p><img alt="perceptron.dot.png" src="perceptron.dot.png"></p>
</div>
<p>Where the weights on the edges of the graph are multiplied by the values from the input nodes and then added together with -18. The constant we add at the end is called a <i>bias</i> value, and an alternative way to notate it is to add an input node for it that always has a value of 1 for the input and -18 for the edge. This is equivalent to the previous graph but makes it a little more consistent.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Perceptron 2"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s2">"rankdir"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"Test"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"Grade"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"e"</span><span class="p">,</span> <span class="s2">"Bias=1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"+"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"Label"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"2"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"e"</span> <span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"-18"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/perceptron_2.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org6ec6cb6">
<p><img alt="perceptron_2.dot.png" src="perceptron_2.dot.png"></p>
</div>
<p>We can re-draw the graph to make it more explicit that there is a separate step-wise function to convert the score to a label, as well as use the more general notation of <i>x</i> and <i>w</i>.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Perceptron 3"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s2">"rankdir"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"Test"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"Grade"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"e"</span><span class="p">,</span> <span class="s2">"Bias=1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"+"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"Step Function"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"f"</span><span class="p">,</span> <span class="s2">"Label"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"2"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"e"</span> <span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"-18"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"f"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/perceptron_3.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="orgdce787c">
<p><img alt="perceptron_3.dot.png" src="perceptron_3.dot.png"></p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org2ae1d0b">
<h2 id="org2ae1d0b">Why are these called neural networks?</h2>
<div class="outline-text-2" id="text-org2ae1d0b">
<p>The perceptron is modeled on a neuron in the brain which takes signal inputs and decides to fire (or not) based on these inputs.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org0526d7b">
<h2 id="org0526d7b">Can perceptrons do logic?</h2>
<div class="outline-text-2" id="text-org0526d7b"></div>
<div class="outline-3" id="outline-container-orgdef1c59">
<h3 id="orgdef1c59">The AND operator</h3>
<div class="outline-text-3" id="text-orgdef1c59">
<p>Here's the truth table for the And operator.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>So how would you make a perceptron for this? Remember that the perceptron is a linear separator, so if you think if the two inputs as axes on the plane, you would fit a line that separates the outputs of 0 from the output of 1.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgf4f2f3b">
<h3 id="orgf4f2f3b">A Perceptron Class</h3>
<div class="outline-text-3" id="text-orgf4f2f3b">
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">Perceptron</span><span class="p">:</span>
    <span class="sd">"""Simple single perceptron</span>

<span class="sd">    Args:</span>
<span class="sd">     weight_x: weight for input x values</span>
<span class="sd">     weight_y: weight for input y values (x2)</span>
<span class="sd">     bias: bias scalar</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weight_x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">weight_y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">bias</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_x</span> <span class="o">=</span> <span class="n">weight_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_y</span> <span class="o">=</span> <span class="n">weight_y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">bias</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">"""calculate score for the inputs</span>

<span class="sd">       Args:</span>
<span class="sd">        x, y: inputs to the linear equation</span>

<span class="sd">       Returns:</span>
<span class="sd">        score: value representing which side of the line the point is</span>
<span class="sd">       """</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_y</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>

    <span class="k">def</span> <span class="nf">separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">"""generates the values for the separation line</span>

<span class="sd">       Args: </span>
<span class="sd">        x: the input value to generate the y-value for</span>

<span class="sd">       Returns:</span>
<span class="sd">        y: value for the plot given x</span>
<span class="sd">       """</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_y</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""Updates the weights</span>

<span class="sd">       Args:</span>
<span class="sd">        weights: array of new weights (including bias)</span>
<span class="sd">       """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_x</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_y</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">"""converts the score to a label</span>

<span class="sd">       This is the stepwise function</span>

<span class="sd">       Args:</span>
<span class="sd">        x, y: point values to check </span>

<span class="sd">       Returns:</span>
<span class="sd">        label: 1 if right of the line, 0 otherwize</span>
<span class="sd">       """</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgb77eb12">
<h3 id="orgb77eb12">A Truth Table Printer</h3>
<div class="outline-text-3" id="text-orgb77eb12">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">truth_table</span><span class="p">(</span><span class="n">perceptron</span><span class="p">):</span>
    <span class="n">binary</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"|Input 1|Input 2| Label|"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"|-+-+-|"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">input_1</span> <span class="ow">in</span> <span class="n">binary</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">input_2</span> <span class="ow">in</span> <span class="n">binary</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">perceptron</span><span class="p">(</span><span class="n">input_1</span><span class="p">,</span> <span class="n">input_2</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">"|</span><span class="si">{}</span><span class="s2">|</span><span class="si">{}</span><span class="s2">|</span><span class="si">{}</span><span class="s2">|"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">input_1</span><span class="p">,</span> <span class="n">input_2</span><span class="p">,</span> <span class="n">output</span><span class="p">))</span>
    <span class="k">return</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">perceptron_and</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">weight_x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight_y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
<p>So now here's the perceptron's truth table.</p>
<div class="highlight">
<pre><span></span><span class="n">truth_table</span><span class="p">(</span><span class="n">perceptron_and</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Label</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Not AND"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="p">[</span><span class="n">perceptron_and</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mf">0.4</span><span class="p">),</span> <span class="n">perceptron_and</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)],</span> <span class="s2">"k"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">"ro"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"AND"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Logical AND"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="orgcfd988f">
<p><img alt="perceptron_and.png" src="perceptron_and.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgccac04e">
<h3 id="orgccac04e">Perceptron OR</h3>
<div class="outline-text-3" id="text-orgccac04e">
<p>A similar thing can be done for the OR operator.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">perceptron_or</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">weight_x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight_y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
<p>And once again I'll check that the perceptron can replicate the truth table.</p>
<div class="highlight">
<pre><span></span><span class="n">truth_table</span><span class="p">(</span><span class="n">perceptron_or</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Label</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Not OR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="n">perceptron_or</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">),</span>
                       <span class="n">perceptron_or</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)],</span> <span class="s2">"k"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">"ro"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"OR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Logical OR"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="orgc05a6d5">
<p><img alt="perceptron_or.png" src="perceptron_or.png"></p>
</div>
<p>If you look at the plot you can see that the separator has to move lower, so, somewhat unintuitively your intercept (bias) should be less negative.</p>
<p>Or you should give more weight to the inputs.</p>
<div class="highlight">
<pre><span></span><span class="n">perceptron_or_2</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">weight_x</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">weight_y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
<p>And here's the table generated with the same bias as the AND perceptron but with heavier weights.</p>
<div class="highlight">
<pre><span></span><span class="n">truth_table</span><span class="p">(</span><span class="n">perceptron_or_2</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Label</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Not OR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="n">perceptron_or_2</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">),</span>
                       <span class="n">perceptron_or_2</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)],</span> <span class="s2">"k"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">"ro"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"OR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Logical OR"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="org3663914">
<p><img alt="perceptron_or_2.png" src="perceptron_or_2.png"></p>
</div>
<p>Seems to work okay.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org179020e">
<h3 id="org179020e">NOT</h3>
<div class="outline-text-3" id="text-org179020e">
<p>The NOT operation only looks at one input. To re-use our perceptron we can set the weights so it ignores the first input and negates the second.</p>
<p>Here's the Truth Table for NOT.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">X</th>
<th class="org-right" scope="col">NOT</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>So now we create a perceptron with an x-weight of 0.</p>
<div class="highlight">
<pre><span></span><span class="n">perceptron_not</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">weight_x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">weight_y</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
<p>And see the output.</p>
<div class="highlight">
<pre><span></span><span class="n">truth_table</span><span class="p">(</span><span class="n">perceptron_not</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Label</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>The table is overkill, since we only need to test two outputs, but it shows that even with the same inputs as the other perceptrons it can negate the second input.</p>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">"ro"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"False"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"True"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="p">[</span><span class="n">perceptron_not</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">),</span> 
                      <span class="n">perceptron_not</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)],</span> <span class="s2">"k"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Logical NOT"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="orgb3c48b0">
<p><img alt="perceptron_not.png" src="perceptron_not.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgcfc9ac7">
<h3 id="orgcfc9ac7">What about the XOR?</h3>
<div class="outline-text-3" id="text-orgcfc9ac7">
<p>The XOR operator only returns True if one or the other input is True, not if both are True.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">XOR</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"XOR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">"ro"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"XOR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Not XOR"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="org5619b16">
<p><img alt="perceptron_xor.png" src="perceptron_xor.png"></p>
</div>
<p>If you look at the plot you can see that a single straight line won't separate the blue and the red dots. The solution turns out to add a layers of perceptrons to make it work.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Multilayer Perceptron"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s1">'rankdir'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"A"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"e"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"f"</span><span class="p">,</span> <span class="s2">"AND"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"g"</span><span class="p">,</span> <span class="s2">"XOR"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">([</span><span class="s2">"ac"</span><span class="p">,</span> <span class="s2">"ad"</span><span class="p">,</span> <span class="s1">'bc'</span><span class="p">,</span> <span class="s1">'bd'</span><span class="p">,</span> <span class="s1">'ce'</span><span class="p">,</span> <span class="s1">'ef'</span><span class="p">,</span> <span class="s1">'df'</span><span class="p">,</span> <span class="s1">'fg'</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/multilayer_perceptron.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org815fde3">
<p><img alt="multilayer_perceptron.dot.png" src="multilayer_perceptron.dot.png"></p>
</div>
<p>A, B, and C are OR, NOT and AND perceptrons, the key is to figure out which is which. The trick is to notice that AND is True when both are true, so we want B to to be 1 everytime there is at least one True and C to negate the one case when they're both True. So B is an OR, C is NOT and A is an AND (because and is True only when they're both True and C negates it).</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Multilayer Perceptron"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s1">'rankdir'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"AND 1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"OR"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"e"</span><span class="p">,</span> <span class="s2">"NOT"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"f"</span><span class="p">,</span> <span class="s2">"AND 2"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"g"</span><span class="p">,</span> <span class="s2">"XOR"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">([</span><span class="s2">"ac"</span><span class="p">,</span> <span class="s2">"ad"</span><span class="p">,</span> <span class="s1">'bc'</span><span class="p">,</span> <span class="s1">'bd'</span><span class="p">,</span> <span class="s1">'ce'</span><span class="p">,</span> <span class="s1">'ef'</span><span class="p">,</span> <span class="s1">'df'</span><span class="p">,</span> <span class="s1">'fg'</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/multilayer_perceptron_2.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org493ab8f">
<p><img alt="multilayer_perceptron_2.dot.png" src="multilayer_perceptron_2.dot.png"></p>
</div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">AND 1</th>
<th class="org-right" scope="col">NOT</th>
<th class="org-right" scope="col">OR</th>
<th class="org-right" scope="col">AND 2</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>It's not the clearest table, but <i>AND 1</i> and <i>OR</i> both take the original inputs, then <i>NOT</i> negates <i>AND 1</i> and the output of <i>NOT</i> and <i>OR</i> feed into <i>AND 2</i> which puts out our exclusive or.</p>
<p>Here's what happens when we use the perceptrons we created earlier to generate the same table.</p>
<div class="highlight">
<pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"| Input 1 | Input 2 | AND 1 | NOT | OR | XOR |"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"|---------+---------+-------+-----+----+-------|"</span><span class="p">)</span>
<span class="n">row</span> <span class="o">=</span> <span class="s2">"|"</span> <span class="o">+</span> <span class="s2">"</span><span class="si">{}</span><span class="s2">|"</span> <span class="o">*</span> <span class="mi">6</span>
<span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
    <span class="n">and_1</span> <span class="o">=</span> <span class="n">perceptron_and</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">nand</span> <span class="o">=</span> <span class="n">perceptron_not</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">and_1</span><span class="p">)</span>
    <span class="n">or_1</span> <span class="o">=</span> <span class="n">perceptron_or</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">xor</span> <span class="o">=</span> <span class="n">perceptron_and</span><span class="p">(</span><span class="n">nand</span><span class="p">,</span> <span class="n">or_1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">and_1</span><span class="p">,</span> <span class="n">nand</span><span class="p">,</span> <span class="n">or_1</span><span class="p">,</span> <span class="n">xor</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">AND 1</th>
<th class="org-right" scope="col">NOT</th>
<th class="org-right" scope="col">OR</th>
<th class="org-right" scope="col">XOR</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>Looks right.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org4bff9a3">
<h3 id="org4bff9a3">Nand</h3>
<div class="outline-text-3" id="text-org4bff9a3">
<p>that the combination or AND and NOT is a NAND operator so you could simplify the diagram a little back to just two layers.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Two-Layer XOR Perceptron"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s1">'rankdir'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"NAND"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"OR"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"f"</span><span class="p">,</span> <span class="s2">"AND"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"g"</span><span class="p">,</span> <span class="s2">"XOR"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">([</span><span class="s2">"ac"</span><span class="p">,</span> <span class="s2">"ad"</span><span class="p">,</span> <span class="s1">'bc'</span><span class="p">,</span> <span class="s1">'bd'</span><span class="p">,</span> <span class="s2">"cf"</span><span class="p">,</span> <span class="s1">'df'</span><span class="p">,</span> <span class="s1">'fg'</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/two_layer_xor.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org4e9378f">
<p><img alt="two_layer_xor.dot.png" src="two_layer_xor.dot.png"></p>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org076ad27">
<h2 id="org076ad27">That's a lot of work to get an XOR, how are we going to classify images like this?</h2>
<div class="outline-text-2" id="text-org076ad27">
<p>This isn't about image classification, but we probably should note that you normally wouldn't try and figure out the parameters by hand, the perceptron can tune itself. The way it does this is by picking some initial random values and then it repeatedly tests how well it did and adjusts the weights.</p>
</div>
<div class="outline-3" id="outline-container-orgf19f24c">
<h3 id="orgf19f24c">How does it adjust the weights?</h3>
<div class="outline-text-3" id="text-orgf19f24c">
<p>This is what's called "the Perceptron Trick". It basically forms a vector for each of the misclassified points \((x_1, x_2, 1)\) and subtracts it from the weights \((w_1, w_2, b)\) if the score was on the positive side and adds to it if the score was on the negative side. It then repeats this for each of the misclassified points. Since we have multiple points we don't want it to just make these huge jumps, so the misclassified points vector is multiplied by some fraction (called the <i>learning rate</i>) so that the changes are small. Once it has the new weights it then tests itself again and makes another adjustment.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org6967eed">
<h3 id="org6967eed">Question</h3>
<div class="outline-text-3" id="text-org6967eed">
<p>If the original line was \(3x_1 + 4x_2 - 10 = 0\), and the learning rate was set to 0.1, how many adjustments would you have to make to reach the point (1, 1)?</p>
<div class="highlight">
<pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">adjustment</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">learning_rate</span>
<span class="n">output</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">adjustments</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">perceptron</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">perceptron</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">adjustments</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">output</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">+</span> <span class="n">direction</span> <span class="o">*</span> <span class="n">adjustment</span>
    <span class="n">perceptron</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Final Output: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">print</span><span class="p">(</span><span class="s2">"Adjustments: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adjustments</span><span class="p">)))</span>
</pre></div>
<pre class="example" id="org10bbb98">
-3
-2.700000000000001
-2.4000000000000012
-2.1000000000000014
-1.8000000000000025
-1.5000000000000036
-1.2000000000000028
-0.9000000000000039
-0.600000000000005
-0.30000000000000604
-7.105427357601002e-15
Final Output: 0.29999999999999183
Adjustments: 11
None
</pre>
<p>I came up with 11 adjustments but Udacity says 10… Close enough, I guess.</p>
</div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../../categories/lecture/" rel="tag">lecture</a></li>
<li><a class="tag p-category" href="../../../../categories/neural-networks/" rel="tag">neural networks</a></li>
<li><a class="tag p-category" href="../../../../categories/perceptrons/" rel="tag">perceptrons</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../introduction-to-neural-networks/" rel="prev" title="Introduction to Neural Networks">Previous post</a></li>
<li class="next"><a href="../the-perceptron-algorithm/" rel="next" title="The Perceptron Algorithm">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer"><a href="https://creativecommons.org/licenses/by/4.0/" rel="license"><img alt="Creative Commons License" id="license-image" src="https://licensebuttons.net/l/by/4.0/80x15.png" style="border-width:0"></a>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0 International License</a>. <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
