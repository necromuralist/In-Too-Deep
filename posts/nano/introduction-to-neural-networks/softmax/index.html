<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="The Softmax Function" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Softmax | In Too Deep</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../../rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/In-Too-Deep/posts/nano/introduction-to-neural-networks/softmax/" rel="canonical"><!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../../site.webmanifest" rel="manifest">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<script async src="../../../assets/javascript/bokeh-1.3.4.min.js" type="text/javascript"></script>
<meta content="Cloistered Monkey" name="author">
<link href="/posts/nano/introduction-to-neural-networks/non-linear-regions/" rel="prev" title="Non-Linear Regions" type="text/html">
<link href="/posts/nano/introduction-to-neural-networks/one-hot-encoding/" rel="next" title="One-Hot Encoding" type="text/html">
<meta content="In Too Deep" property="og:site_name">
<meta content="Softmax" property="og:title">
<meta content="https://necromuralist.github.io/In-Too-Deep/posts/nano/introduction-to-neural-networks/softmax/" property="og:url">
<meta content="The Softmax Function" property="og:description">
<meta content="article" property="og:type">
<meta content="2018-10-23T07:44:24-07:00" property="article:published_time">
<meta content="lecture" property="article:tag">
<meta content="neural networks" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="https://necromuralist.github.io/In-Too-Deep/"><span id="blog-title">In Too Deep</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="/archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="/categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="/rss.xml">RSS feed</a></li>
<li class="nav-item"><a class="nav-link" href="https://necromuralist.github.io/">Cloistered Monkey</a></li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/In-Too-Deep/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="/posts/nano/introduction-to-neural-networks/softmax/index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href="/posts/nano/introduction-to-neural-networks/softmax/">Softmax</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/nano/introduction-to-neural-networks/softmax/" rel="bookmark"><time class="published dt-published" datetime="2018-10-23T07:44:24-07:00" itemprop="datePublished" title="2018-10-23 07:44">2018-10-23 07:44</time></a></p>
<p class="sourceline"><a class="sourcelink" href="/posts/nano/introduction-to-neural-networks/softmax/index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/nano/introduction-to-neural-networks/softmax/#orgac67576">What is the Softmax Function?</a></li>
<li><a href="/posts/nano/introduction-to-neural-networks/softmax/#org4fff52b">A classification problem</a></li>
<li><a href="/posts/nano/introduction-to-neural-networks/softmax/#org7a9dcea">The Exponential</a></li>
<li><a href="/posts/nano/introduction-to-neural-networks/softmax/#org347532d">Implementation</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgac67576">
<h2 id="orgac67576">What is the Softmax Function?</h2>
<div class="outline-text-2" id="text-orgac67576">
<p>With the stepwise and logistic function you are limited to binary classifications. The <a href="https://en.wikipedia.org/wiki/Softmax_function">softmax</a> function is a generalization of the logistic (sigmoid) function that lets you choose between multiple categories.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org4fff52b">
<h2 id="org4fff52b">A classification problem</h2>
<div class="outline-text-2" id="text-org4fff52b"></div>
<div class="outline-3" id="outline-container-org8f31504">
<h3 id="org8f31504">What animal did you see?</h3>
<div class="outline-text-3" id="text-org8f31504">
<p>We have three animals and the probabilities that the animal you saw are the following:</p>
<ul class="org-ul">
<li>P(duck) = 0.67</li>
<li>P(beaver) = 0.24</li>
<li>P(walrus) = 0.09</li>
</ul>
<p>We count the occurrence of animals we see and get these counts.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Animal</th>
<th class="org-right" scope="col">Count</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Duck</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-left">Beaver</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Walrus</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>So, how do you convert these scores into probabilities?</p>
</div>
</div>
<div class="outline-3" id="outline-container-org68104f5">
<h3 id="org68104f5">Standardize</h3>
<div class="outline-text-3" id="text-org68104f5">
<p>One way to convert the counts to probabilities is by dividing each count by the total.</p>
<p>\[ P = \frac{count}{\textit{total count}} \]</p>
<p>The problem with this is we might not be dealing with counts and so we have to deal with negative numbers in which case the sum of the values (total count in this case) could equal zero. We need to use a function that will turn any value we have (even if it isn't a count) into a positive number.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgef57c84">
<h3 id="orgef57c84">Which function would turn every number into a positive number?</h3>
<div class="outline-text-3" id="text-orgef57c84">
<ul class="org-ul">
<li class="off"><code>[&nbsp;]</code> sin</li>
<li class="off"><code>[&nbsp;]</code> cos</li>
<li class="off"><code>[&nbsp;]</code> log</li>
<li class="on"><code>[X]</code> exp</li>
</ul>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org7a9dcea">
<h2 id="org7a9dcea">The Exponential</h2>
<div class="outline-text-2" id="text-org7a9dcea">
<p>It turns out that if you take the numbers and use them as the power of <i>e</i>, your values will always be positive, so to normalize our values, instead of taking the count divided by the sum of the counts, we would take the exponential of our count divided by the sum of the exponentials of all the counts.</p>
<p>\[ P(duck) = \frac{e^2}{e^2 + e^1 + e^0}\\ = 0.67 \]</p>
<p>This is the <i>softmax</i> function.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org347532d">
<h2 id="org347532d">Implementation</h2>
<div class="outline-text-2" id="text-org347532d"></div>
<div class="outline-3" id="outline-container-orgeb28688">
<h3 id="orgeb28688">Imports</h3>
<div class="outline-text-3" id="text-orgeb28688">/home/brunhilde/.virtualenvs/In-Too-Deep/bin/python3: No module named virtualfish
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
<p>Write a function that takes as input a list of numbers, and returns the list of values given by the softmax function. This uses <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.exp.html">numpy.exp</a> to approximate <a href="https://en.wikipedia.org/wiki/E_(mathematical_constant)">e</a>.</p>
/home/brunhilde/.virtualenvs/In-Too-Deep/bin/python3: No module named virtualfish
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="sd">"""calculates the softmax probmabilities</span>

<span class="sd">    Args:</span>
<span class="sd">     L: List of values</span>

<span class="sd">    Returns:</span>
<span class="sd">     softmax: the softmax probabilities for the values</span>
<span class="sd">    """</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span><span class="o">/</span><span class="n">values</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
/home/brunhilde/.virtualenvs/In-Too-Deep/bin/python3: No module named virtualfish
<div class="highlight">
<pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">expected_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">]</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">**</span><span class="mi">2</span>
<span class="n">expected_actual</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">expected_values</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">expected_actual</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"{:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">actual</span><span class="p">))</span>
    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">actual</span> <span class="o">-</span> <span class="n">expected</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">,</span>\
        <span class="s2">"Expected: {} Actual: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
</pre></div>
<pre class="example">
0.67
0.24
0.09

</pre></div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="/categories/lecture/" rel="tag">lecture</a></li>
<li><a class="tag p-category" href="/categories/neural-networks/" rel="tag">neural networks</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="/posts/nano/introduction-to-neural-networks/non-linear-regions/" rel="prev" title="Non-Linear Regions">Previous post</a></li>
<li class="next"><a href="/posts/nano/introduction-to-neural-networks/one-hot-encoding/" rel="next" title="One-Hot Encoding">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Contents © 2019 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="/assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script> 
</body>
</html>
