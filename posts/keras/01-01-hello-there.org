#+BEGIN_COMMENT
.. title: Hello There
.. slug: hello-there
.. date: 2019-06-25 06:59:52 UTC-07:00
.. tags: keras,notes
.. category: Notes
.. link: 
.. description: A Keras Hello World.
.. type: text

#+END_COMMENT
#+PROPERTY: header-args :session /home/athena/.local/share/jupyter/runtime/kernel-e463d41b-4478-41d8-9556-45fce72f80d5.json
#+OPTIONS: ^:{}
#+TOC: headlines 2
#+BEGIN_SRC python :results none :exports none
%load_ext autoreload
%autoreload 2
#+END_SRC
* Beginning
  This 'Hello World' takes data created by a simple linear model and trains a neural network to model it. The actual model will take this form:

\[
y = mx + b
\]
** Imports
*** Python
#+begin_src python :results none
from argparse import Namespace
from functools import partial
from pathlib import Path
import random
#+end_src
*** PyPi
#+begin_src python :results none
from sklearn import linear_model
from tensorflow import keras
import hvplot.pandas
import numpy
import pandas
#+end_src
*** My Stuff
#+begin_src python :results none
from graeae.visualization.embed import EmbedHoloview as EmbedHoloviews
#+end_src

** Set Up
*** Plotting
#+begin_src python :results none
Embed = partial(EmbedHoloviews, 
                folder_path=Path("../../files/posts/keras/hello-there/"))

Plot = Namespace(
    height=800,
    width=1000,
)
holoviews.extension("bokeh")
#+end_src

*** The Random Seed
#+begin_src python :results none
numpy.random.seed(2019)
#+end_src
* Middle
** The Data

#+begin_src python :results output :exports both
X = 20 * numpy.random.random_sample((10,)) - 10
slope = random.randrange(2, 10)
intercept = random.randrange(200)
Y = slope * X + intercept
print(X)
print(Y)
data = pandas.DataFrame(dict(X=X,
                             Y=Y))
#+end_src

#+RESULTS:
: [ 8.06964429 -2.13838987  2.47939923  2.75754802  7.60998138 -4.01655961
:   4.0439654   8.06412323  7.62763853 -1.88500404]
: [109.34822144  58.30805067  81.39699613  82.7877401  107.04990688
:   48.91720194  89.21982702 109.32061613 107.13819265  59.5749798 ]

Our line is

#+begin_src python :results output raw :exports both
print("\\[")
print(f"y = {slope} x + {intercept}")
print("\\]")
#+end_src

#+RESULTS:
\[
 y = 5 x + 69
\]


#+begin_src python :results none
plot = data.hvplot.scatter(x="X", y="Y").opts(
    title="The Dataset",
    height=Plot.height,
    width=Plot.width,
)
source = Embed(plot=plot, file_name="data_scatter")()
#+end_src

#+begin_src python :results output html :exports output
print(source)
#+end_src

#+RESULTS:
#+begin_export html
: <object type="text/html" data="data_scatter.html" style="width:100%" height=800>
:   <p>Figure Missing</p>
: </object>
#+end_export
** Defining the Neural Network
    Our model will be a fully-connected network with one layer with one neuron that takes one input.

 - [[https://www.tensorflow.org/api_docs/python/tf/keras/Sequential][Sequential]] : A linear stack of layers
 - [[https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dense][Dense]]: A densely connected neural network layer

#+begin_src python :results none
model = keras.Sequential()
model.add(keras.layers.Dense(units=1, input_shape=[1]))
#+end_src

*Note:* The original notebook passed the Dense layer into the constructor, but this gives a warning that you should pass in the dtype instead. Adding it to the constructed object seems to be the way they prefer to do it currently.

** Compiling the Model
   "Compiling" in this case means telling the model what optimizer and loss methods to use. In this case it will be [[https://en.wikipedia.org/wiki/Stochastic_gradient_descent?oldformat=true][Stochastic Gradient Descent]] and [[https://en.wikipedia.org/wiki/Mean_squared_error?oldformat=true][Mean Squared Error]].

 - [[https://www.tensorflow.org/api_docs/python/tf/keras/Sequential#compile][=Sequential.compile=]]

#+begin_src python :results none
model.compile(optimizer='sgd', loss='mean_squared_error')
#+end_src

** Training The Model
   Training is done with the model's [[https://www.tensorflow.org/api_docs/python/tf/keras/Sequential#fit][fit]] method. =epochs= is the number of times to repeat training.

#+begin_src python :results output :exports both
model.fit(X, Y, epochs=500)
#+end_src

#+RESULTS:
#+begin_example
Train on 10 samples
Epoch 1/500
10/10 [==============================] - 1s 64ms/sample - loss: 8561.9756
Epoch 2/500
10/10 [==============================] - 0s 243us/sample - loss: 3731.6470
Epoch 3/500
10/10 [==============================] - 0s 285us/sample - loss: 2929.6824
Epoch 4/500
10/10 [==============================] - 0s 307us/sample - loss: 2746.8979
Epoch 5/500
10/10 [==============================] - 0s 305us/sample - loss: 2660.5632
Epoch 6/500
10/10 [==============================] - 0s 322us/sample - loss: 2590.4958
Epoch 7/500
10/10 [==============================] - 0s 309us/sample - loss: 2524.3647
Epoch 8/500
10/10 [==============================] - 0s 289us/sample - loss: 2460.2427
Epoch 9/500
10/10 [==============================] - 0s 322us/sample - loss: 2397.7988
Epoch 10/500
10/10 [==============================] - 0s 315us/sample - loss: 2336.9475
Epoch 11/500
10/10 [==============================] - 0s 273us/sample - loss: 2277.6411
Epoch 12/500
10/10 [==============================] - 0s 331us/sample - loss: 2219.8403
Epoch 13/500
10/10 [==============================] - 0s 314us/sample - loss: 2163.5063
Epoch 14/500
10/10 [==============================] - 0s 347us/sample - loss: 2108.6018
Epoch 15/500
10/10 [==============================] - 0s 323us/sample - loss: 2055.0908
Epoch 16/500
10/10 [==============================] - 0s 302us/sample - loss: 2002.9379
Epoch 17/500
10/10 [==============================] - 0s 261us/sample - loss: 1952.1086
Epoch 18/500
10/10 [==============================] - 0s 414us/sample - loss: 1902.5686
Epoch 19/500
10/10 [==============================] - 0s 324us/sample - loss: 1854.2861
Epoch 20/500
10/10 [==============================] - 0s 306us/sample - loss: 1807.2291
Epoch 21/500
10/10 [==============================] - 0s 320us/sample - loss: 1761.3662
Epoch 22/500
10/10 [==============================] - 0s 263us/sample - loss: 1716.6670
Epoch 23/500
10/10 [==============================] - 0s 348us/sample - loss: 1673.1023
Epoch 24/500
10/10 [==============================] - 0s 302us/sample - loss: 1630.6432
Epoch 25/500
10/10 [==============================] - 0s 316us/sample - loss: 1589.2615
Epoch 26/500
10/10 [==============================] - 0s 255us/sample - loss: 1548.9301
Epoch 27/500
10/10 [==============================] - 0s 369us/sample - loss: 1509.6222
Epoch 28/500
10/10 [==============================] - 0s 301us/sample - loss: 1471.3116
Epoch 29/500
10/10 [==============================] - 0s 323us/sample - loss: 1433.9734
Epoch 30/500
10/10 [==============================] - 0s 291us/sample - loss: 1397.5828
Epoch 31/500
10/10 [==============================] - 0s 349us/sample - loss: 1362.1156
Epoch 32/500
10/10 [==============================] - 0s 347us/sample - loss: 1327.5486
Epoch 33/500
10/10 [==============================] - 0s 260us/sample - loss: 1293.8588
Epoch 34/500
10/10 [==============================] - 0s 373us/sample - loss: 1261.0237
Epoch 35/500
10/10 [==============================] - 0s 282us/sample - loss: 1229.0222
Epoch 36/500
10/10 [==============================] - 0s 235us/sample - loss: 1197.8328
Epoch 37/500
10/10 [==============================] - 0s 170us/sample - loss: 1167.4348
Epoch 38/500
10/10 [==============================] - 0s 149us/sample - loss: 1137.8082
Epoch 39/500
10/10 [==============================] - 0s 241us/sample - loss: 1108.9335
Epoch 40/500
10/10 [==============================] - 0s 135us/sample - loss: 1080.7915
Epoch 41/500
10/10 [==============================] - 0s 100us/sample - loss: 1053.3639
Epoch 42/500
10/10 [==============================] - 0s 98us/sample - loss: 1026.6320
Epoch 43/500
10/10 [==============================] - 0s 233us/sample - loss: 1000.5785
Epoch 44/500
10/10 [==============================] - 0s 83us/sample - loss: 975.1864
Epoch 45/500
10/10 [==============================] - 0s 85us/sample - loss: 950.4386
Epoch 46/500
10/10 [==============================] - 0s 86us/sample - loss: 926.3190
Epoch 47/500
10/10 [==============================] - 0s 91us/sample - loss: 902.8112
Epoch 48/500
10/10 [==============================] - 0s 84us/sample - loss: 879.9002
Epoch 49/500
10/10 [==============================] - 0s 92us/sample - loss: 857.5706
Epoch 50/500
10/10 [==============================] - 0s 76us/sample - loss: 835.8076
Epoch 51/500
10/10 [==============================] - 0s 87us/sample - loss: 814.5967
Epoch 52/500
10/10 [==============================] - 0s 90us/sample - loss: 793.9244
Epoch 53/500
10/10 [==============================] - 0s 88us/sample - loss: 773.7766
Epoch 54/500
10/10 [==============================] - 0s 106us/sample - loss: 754.1401
Epoch 55/500
10/10 [==============================] - 0s 84us/sample - loss: 735.0020
Epoch 56/500
10/10 [==============================] - 0s 75us/sample - loss: 716.3495
Epoch 57/500
10/10 [==============================] - 0s 72us/sample - loss: 698.1703
Epoch 58/500
10/10 [==============================] - 0s 110us/sample - loss: 680.4526
Epoch 59/500
10/10 [==============================] - 0s 90us/sample - loss: 663.1844
Epoch 60/500
10/10 [==============================] - 0s 90us/sample - loss: 646.3546
Epoch 61/500
10/10 [==============================] - 0s 115us/sample - loss: 629.9517
Epoch 62/500
10/10 [==============================] - 0s 87us/sample - loss: 613.9650
Epoch 63/500
10/10 [==============================] - 0s 87us/sample - loss: 598.3842
Epoch 64/500
10/10 [==============================] - 0s 92us/sample - loss: 583.1986
Epoch 65/500
10/10 [==============================] - 0s 92us/sample - loss: 568.3985
Epoch 66/500
10/10 [==============================] - 0s 93us/sample - loss: 553.9739
Epoch 67/500
10/10 [==============================] - 0s 84us/sample - loss: 539.9155
Epoch 68/500
10/10 [==============================] - 0s 94us/sample - loss: 526.2137
Epoch 69/500
10/10 [==============================] - 0s 87us/sample - loss: 512.8597
Epoch 70/500
10/10 [==============================] - 0s 84us/sample - loss: 499.8447
Epoch 71/500
10/10 [==============================] - 0s 88us/sample - loss: 487.1598
Epoch 72/500
10/10 [==============================] - 0s 112us/sample - loss: 474.7970
Epoch 73/500
10/10 [==============================] - 0s 87us/sample - loss: 462.7479
Epoch 74/500
10/10 [==============================] - 0s 87us/sample - loss: 451.0044
Epoch 75/500
10/10 [==============================] - 0s 91us/sample - loss: 439.5591
Epoch 76/500
10/10 [==============================] - 0s 90us/sample - loss: 428.4041
Epoch 77/500
10/10 [==============================] - 0s 89us/sample - loss: 417.5323
Epoch 78/500
10/10 [==============================] - 0s 93us/sample - loss: 406.9364
Epoch 79/500
10/10 [==============================] - 0s 89us/sample - loss: 396.6093
Epoch 80/500
10/10 [==============================] - 0s 86us/sample - loss: 386.5443
Epoch 81/500
10/10 [==============================] - 0s 87us/sample - loss: 376.7347
Epoch 82/500
10/10 [==============================] - 0s 112us/sample - loss: 367.1743
Epoch 83/500
10/10 [==============================] - 0s 85us/sample - loss: 357.8564
Epoch 84/500
10/10 [==============================] - 0s 110us/sample - loss: 348.7748
Epoch 85/500
10/10 [==============================] - 0s 81us/sample - loss: 339.9238
Epoch 86/500
10/10 [==============================] - 0s 70us/sample - loss: 331.2974
Epoch 87/500
10/10 [==============================] - 0s 116us/sample - loss: 322.8898
Epoch 88/500
10/10 [==============================] - 0s 87us/sample - loss: 314.6957
Epoch 89/500
10/10 [==============================] - 0s 118us/sample - loss: 306.7095
Epoch 90/500
10/10 [==============================] - 0s 89us/sample - loss: 298.9261
Epoch 91/500
10/10 [==============================] - 0s 76us/sample - loss: 291.3401
Epoch 92/500
10/10 [==============================] - 0s 118us/sample - loss: 283.9466
Epoch 93/500
10/10 [==============================] - 0s 77us/sample - loss: 276.7408
Epoch 94/500
10/10 [==============================] - 0s 93us/sample - loss: 269.7178
Epoch 95/500
10/10 [==============================] - 0s 88us/sample - loss: 262.8730
Epoch 96/500
10/10 [==============================] - 0s 112us/sample - loss: 256.2020
Epoch 97/500
10/10 [==============================] - 0s 91us/sample - loss: 249.7002
Epoch 98/500
10/10 [==============================] - 0s 90us/sample - loss: 243.3634
Epoch 99/500
10/10 [==============================] - 0s 116us/sample - loss: 237.1875
Epoch 100/500
10/10 [==============================] - 0s 94us/sample - loss: 231.1683
Epoch 101/500
10/10 [==============================] - 0s 91us/sample - loss: 225.3018
Epoch 102/500
10/10 [==============================] - 0s 94us/sample - loss: 219.5842
Epoch 103/500
10/10 [==============================] - 0s 91us/sample - loss: 214.0117
Epoch 104/500
10/10 [==============================] - 0s 90us/sample - loss: 208.5806
Epoch 105/500
10/10 [==============================] - 0s 87us/sample - loss: 203.2874
Epoch 106/500
10/10 [==============================] - 0s 111us/sample - loss: 198.1284
Epoch 107/500
10/10 [==============================] - 0s 91us/sample - loss: 193.1004
Epoch 108/500
10/10 [==============================] - 0s 85us/sample - loss: 188.2000
Epoch 109/500
10/10 [==============================] - 0s 90us/sample - loss: 183.4240
Epoch 110/500
10/10 [==============================] - 0s 117us/sample - loss: 178.7691
Epoch 111/500
10/10 [==============================] - 0s 80us/sample - loss: 174.2324
Epoch 112/500
10/10 [==============================] - 0s 88us/sample - loss: 169.8108
Epoch 113/500
10/10 [==============================] - 0s 86us/sample - loss: 165.5014
Epoch 114/500
10/10 [==============================] - 0s 82us/sample - loss: 161.3014
Epoch 115/500
10/10 [==============================] - 0s 87us/sample - loss: 157.2079
Epoch 116/500
10/10 [==============================] - 0s 90us/sample - loss: 153.2184
Epoch 117/500
10/10 [==============================] - 0s 109us/sample - loss: 149.3301
Epoch 118/500
10/10 [==============================] - 0s 86us/sample - loss: 145.5404
Epoch 119/500
10/10 [==============================] - 0s 90us/sample - loss: 141.8470
Epoch 120/500
10/10 [==============================] - 0s 94us/sample - loss: 138.2472
Epoch 121/500
10/10 [==============================] - 0s 86us/sample - loss: 134.7389
Epoch 122/500
10/10 [==============================] - 0s 88us/sample - loss: 131.3195
Epoch 123/500
10/10 [==============================] - 0s 75us/sample - loss: 127.9870
Epoch 124/500
10/10 [==============================] - 0s 83us/sample - loss: 124.7390
Epoch 125/500
10/10 [==============================] - 0s 84us/sample - loss: 121.5734
Epoch 126/500
10/10 [==============================] - 0s 91us/sample - loss: 118.4882
Epoch 127/500
10/10 [==============================] - 0s 102us/sample - loss: 115.4813
Epoch 128/500
10/10 [==============================] - 0s 89us/sample - loss: 112.5506
Epoch 129/500
10/10 [==============================] - 0s 94us/sample - loss: 109.6944
Epoch 130/500
10/10 [==============================] - 0s 94us/sample - loss: 106.9106
Epoch 131/500
10/10 [==============================] - 0s 88us/sample - loss: 104.1975
Epoch 132/500
10/10 [==============================] - 0s 85us/sample - loss: 101.5532
Epoch 133/500
10/10 [==============================] - 0s 97us/sample - loss: 98.9761
Epoch 134/500
10/10 [==============================] - 0s 81us/sample - loss: 96.4643
Epoch 135/500
10/10 [==============================] - 0s 76us/sample - loss: 94.0162
Epoch 136/500
10/10 [==============================] - 0s 88us/sample - loss: 91.6303
Epoch 137/500
10/10 [==============================] - 0s 108us/sample - loss: 89.3050
Epoch 138/500
10/10 [==============================] - 0s 84us/sample - loss: 87.0386
Epoch 139/500
10/10 [==============================] - 0s 75us/sample - loss: 84.8298
Epoch 140/500
10/10 [==============================] - 0s 83us/sample - loss: 82.6770
Epoch 141/500
10/10 [==============================] - 0s 89us/sample - loss: 80.5790
Epoch 142/500
10/10 [==============================] - 0s 84us/sample - loss: 78.5340
Epoch 143/500
10/10 [==============================] - 0s 84us/sample - loss: 76.5410
Epoch 144/500
10/10 [==============================] - 0s 81us/sample - loss: 74.5986
Epoch 145/500
10/10 [==============================] - 0s 103us/sample - loss: 72.7055
Epoch 146/500
10/10 [==============================] - 0s 87us/sample - loss: 70.8604
Epoch 147/500
10/10 [==============================] - 0s 108us/sample - loss: 69.0622
Epoch 148/500
10/10 [==============================] - 0s 94us/sample - loss: 67.3095
Epoch 149/500
10/10 [==============================] - 0s 94us/sample - loss: 65.6014
Epoch 150/500
10/10 [==============================] - 0s 90us/sample - loss: 63.9366
Epoch 151/500
10/10 [==============================] - 0s 93us/sample - loss: 62.3140
Epoch 152/500
10/10 [==============================] - 0s 110us/sample - loss: 60.7326
Epoch 153/500
10/10 [==============================] - 0s 87us/sample - loss: 59.1914
Epoch 154/500
10/10 [==============================] - 0s 92us/sample - loss: 57.6892
Epoch 155/500
10/10 [==============================] - 0s 96us/sample - loss: 56.2252
Epoch 156/500
10/10 [==============================] - 0s 100us/sample - loss: 54.7984
Epoch 157/500
10/10 [==============================] - 0s 84us/sample - loss: 53.4077
Epoch 158/500
10/10 [==============================] - 0s 95us/sample - loss: 52.0524
Epoch 159/500
10/10 [==============================] - 0s 109us/sample - loss: 50.7314
Epoch 160/500
10/10 [==============================] - 0s 88us/sample - loss: 49.4440
Epoch 161/500
10/10 [==============================] - 0s 93us/sample - loss: 48.1892
Epoch 162/500
10/10 [==============================] - 0s 129us/sample - loss: 46.9663
Epoch 163/500
10/10 [==============================] - 0s 88us/sample - loss: 45.7744
Epoch 164/500
10/10 [==============================] - 0s 91us/sample - loss: 44.6128
Epoch 165/500
10/10 [==============================] - 0s 84us/sample - loss: 43.4806
Epoch 166/500
10/10 [==============================] - 0s 86us/sample - loss: 42.3772
Epoch 167/500
10/10 [==============================] - 0s 84us/sample - loss: 41.3018
Epoch 168/500
10/10 [==============================] - 0s 69us/sample - loss: 40.2536
Epoch 169/500
10/10 [==============================] - 0s 68us/sample - loss: 39.2321
Epoch 170/500
10/10 [==============================] - 0s 68us/sample - loss: 38.2365
Epoch 171/500
10/10 [==============================] - 0s 70us/sample - loss: 37.2662
Epoch 172/500
10/10 [==============================] - 0s 58us/sample - loss: 36.3204
Epoch 173/500
10/10 [==============================] - 0s 60us/sample - loss: 35.3987
Epoch 174/500
10/10 [==============================] - 0s 59us/sample - loss: 34.5004
Epoch 175/500
10/10 [==============================] - 0s 62us/sample - loss: 33.6249
Epoch 176/500
10/10 [==============================] - 0s 64us/sample - loss: 32.7715
Epoch 177/500
10/10 [==============================] - 0s 77us/sample - loss: 31.9399
Epoch 178/500
10/10 [==============================] - 0s 62us/sample - loss: 31.1293
Epoch 179/500
10/10 [==============================] - 0s 58us/sample - loss: 30.3393
Epoch 180/500
10/10 [==============================] - 0s 78us/sample - loss: 29.5694
Epoch 181/500
10/10 [==============================] - 0s 62us/sample - loss: 28.8190
Epoch 182/500
10/10 [==============================] - 0s 55us/sample - loss: 28.0877
Epoch 183/500
10/10 [==============================] - 0s 68us/sample - loss: 27.3749
Epoch 184/500
10/10 [==============================] - 0s 59us/sample - loss: 26.6802
Epoch 185/500
10/10 [==============================] - 0s 79us/sample - loss: 26.0031
Epoch 186/500
10/10 [==============================] - 0s 62us/sample - loss: 25.3432
Epoch 187/500
10/10 [==============================] - 0s 64us/sample - loss: 24.7000
Epoch 188/500
10/10 [==============================] - 0s 64us/sample - loss: 24.0732
Epoch 189/500
10/10 [==============================] - 0s 60us/sample - loss: 23.4623
Epoch 190/500
10/10 [==============================] - 0s 83us/sample - loss: 22.8669
Epoch 191/500
10/10 [==============================] - 0s 69us/sample - loss: 22.2866
Epoch 192/500
10/10 [==============================] - 0s 63us/sample - loss: 21.7210
Epoch 193/500
10/10 [==============================] - 0s 59us/sample - loss: 21.1698
Epoch 194/500
10/10 [==============================] - 0s 79us/sample - loss: 20.6326
Epoch 195/500
10/10 [==============================] - 0s 64us/sample - loss: 20.1090
Epoch 196/500
10/10 [==============================] - 0s 63us/sample - loss: 19.5986
Epoch 197/500
10/10 [==============================] - 0s 67us/sample - loss: 19.1013
Epoch 198/500
10/10 [==============================] - 0s 83us/sample - loss: 18.6166
Epoch 199/500
10/10 [==============================] - 0s 81us/sample - loss: 18.1441
Epoch 200/500
10/10 [==============================] - 0s 76us/sample - loss: 17.6836
Epoch 201/500
10/10 [==============================] - 0s 56us/sample - loss: 17.2349
Epoch 202/500
10/10 [==============================] - 0s 64us/sample - loss: 16.7975
Epoch 203/500
10/10 [==============================] - 0s 60us/sample - loss: 16.3712
Epoch 204/500
10/10 [==============================] - 0s 68us/sample - loss: 15.9558
Epoch 205/500
10/10 [==============================] - 0s 57us/sample - loss: 15.5509
Epoch 206/500
10/10 [==============================] - 0s 63us/sample - loss: 15.1562
Epoch 207/500
10/10 [==============================] - 0s 60us/sample - loss: 14.7716
Epoch 208/500
10/10 [==============================] - 0s 66us/sample - loss: 14.3967
Epoch 209/500
10/10 [==============================] - 0s 82us/sample - loss: 14.0314
Epoch 210/500
10/10 [==============================] - 0s 63us/sample - loss: 13.6753
Epoch 211/500
10/10 [==============================] - 0s 64us/sample - loss: 13.3282
Epoch 212/500
10/10 [==============================] - 0s 73us/sample - loss: 12.9900
Epoch 213/500
10/10 [==============================] - 0s 64us/sample - loss: 12.6603
Epoch 214/500
10/10 [==============================] - 0s 56us/sample - loss: 12.3390
Epoch 215/500
10/10 [==============================] - 0s 69us/sample - loss: 12.0259
Epoch 216/500
10/10 [==============================] - 0s 59us/sample - loss: 11.7207
Epoch 217/500
10/10 [==============================] - 0s 63us/sample - loss: 11.4233
Epoch 218/500
10/10 [==============================] - 0s 66us/sample - loss: 11.1334
Epoch 219/500
10/10 [==============================] - 0s 58us/sample - loss: 10.8508
Epoch 220/500
10/10 [==============================] - 0s 60us/sample - loss: 10.5755
Epoch 221/500
10/10 [==============================] - 0s 65us/sample - loss: 10.3071
Epoch 222/500
10/10 [==============================] - 0s 74us/sample - loss: 10.0455
Epoch 223/500
10/10 [==============================] - 0s 74us/sample - loss: 9.7906
Epoch 224/500
10/10 [==============================] - 0s 63us/sample - loss: 9.5421
Epoch 225/500
10/10 [==============================] - 0s 58us/sample - loss: 9.3000
Epoch 226/500
10/10 [==============================] - 0s 62us/sample - loss: 9.0640
Epoch 227/500
10/10 [==============================] - 0s 98us/sample - loss: 8.8339
Epoch 228/500
10/10 [==============================] - 0s 65us/sample - loss: 8.6098
Epoch 229/500
10/10 [==============================] - 0s 63us/sample - loss: 8.3913
Epoch 230/500
10/10 [==============================] - 0s 72us/sample - loss: 8.1783
Epoch 231/500
10/10 [==============================] - 0s 69us/sample - loss: 7.9708
Epoch 232/500
10/10 [==============================] - 0s 74us/sample - loss: 7.7685
Epoch 233/500
10/10 [==============================] - 0s 62us/sample - loss: 7.5713
Epoch 234/500
10/10 [==============================] - 0s 63us/sample - loss: 7.3792
Epoch 235/500
10/10 [==============================] - 0s 93us/sample - loss: 7.1919
Epoch 236/500
10/10 [==============================] - 0s 67us/sample - loss: 7.0094
Epoch 237/500
10/10 [==============================] - 0s 64us/sample - loss: 6.8315
Epoch 238/500
10/10 [==============================] - 0s 64us/sample - loss: 6.6582
Epoch 239/500
10/10 [==============================] - 0s 66us/sample - loss: 6.4892
Epoch 240/500
10/10 [==============================] - 0s 71us/sample - loss: 6.3245
Epoch 241/500
10/10 [==============================] - 0s 64us/sample - loss: 6.1640
Epoch 242/500
10/10 [==============================] - 0s 55us/sample - loss: 6.0076
Epoch 243/500
10/10 [==============================] - 0s 64us/sample - loss: 5.8551
Epoch 244/500
10/10 [==============================] - 0s 64us/sample - loss: 5.7065
Epoch 245/500
10/10 [==============================] - 0s 81us/sample - loss: 5.5617
Epoch 246/500
10/10 [==============================] - 0s 63us/sample - loss: 5.4206
Epoch 247/500
10/10 [==============================] - 0s 76us/sample - loss: 5.2830
Epoch 248/500
10/10 [==============================] - 0s 66us/sample - loss: 5.1490
Epoch 249/500
10/10 [==============================] - 0s 64us/sample - loss: 5.0183
Epoch 250/500
10/10 [==============================] - 0s 78us/sample - loss: 4.8909
Epoch 251/500
10/10 [==============================] - 0s 80us/sample - loss: 4.7668
Epoch 252/500
10/10 [==============================] - 0s 70us/sample - loss: 4.6459
Epoch 253/500
10/10 [==============================] - 0s 64us/sample - loss: 4.5279
Epoch 254/500
10/10 [==============================] - 0s 65us/sample - loss: 4.4130
Epoch 255/500
10/10 [==============================] - 0s 61us/sample - loss: 4.3010
Epoch 256/500
10/10 [==============================] - 0s 69us/sample - loss: 4.1919
Epoch 257/500
10/10 [==============================] - 0s 61us/sample - loss: 4.0855
Epoch 258/500
10/10 [==============================] - 0s 56us/sample - loss: 3.9818
Epoch 259/500
10/10 [==============================] - 0s 61us/sample - loss: 3.8808
Epoch 260/500
10/10 [==============================] - 0s 57us/sample - loss: 3.7823
Epoch 261/500
10/10 [==============================] - 0s 70us/sample - loss: 3.6863
Epoch 262/500
10/10 [==============================] - 0s 62us/sample - loss: 3.5928
Epoch 263/500
10/10 [==============================] - 0s 60us/sample - loss: 3.5016
Epoch 264/500
10/10 [==============================] - 0s 74us/sample - loss: 3.4127
Epoch 265/500
10/10 [==============================] - 0s 61us/sample - loss: 3.3261
Epoch 266/500
10/10 [==============================] - 0s 59us/sample - loss: 3.2417
Epoch 267/500
10/10 [==============================] - 0s 54us/sample - loss: 3.1595
Epoch 268/500
10/10 [==============================] - 0s 87us/sample - loss: 3.0793
Epoch 269/500
10/10 [==============================] - 0s 62us/sample - loss: 3.0011
Epoch 270/500
10/10 [==============================] - 0s 59us/sample - loss: 2.9250
Epoch 271/500
10/10 [==============================] - 0s 77us/sample - loss: 2.8507
Epoch 272/500
10/10 [==============================] - 0s 64us/sample - loss: 2.7784
Epoch 273/500
10/10 [==============================] - 0s 62us/sample - loss: 2.7079
Epoch 274/500
10/10 [==============================] - 0s 63us/sample - loss: 2.6392
Epoch 275/500
10/10 [==============================] - 0s 103us/sample - loss: 2.5722
Epoch 276/500
10/10 [==============================] - 0s 67us/sample - loss: 2.5069
Epoch 277/500
10/10 [==============================] - 0s 68us/sample - loss: 2.4433
Epoch 278/500
10/10 [==============================] - 0s 83us/sample - loss: 2.3813
Epoch 279/500
10/10 [==============================] - 0s 92us/sample - loss: 2.3209
Epoch 280/500
10/10 [==============================] - 0s 84us/sample - loss: 2.2620
Epoch 281/500
10/10 [==============================] - 0s 71us/sample - loss: 2.2046
Epoch 282/500
10/10 [==============================] - 0s 71us/sample - loss: 2.1486
Epoch 283/500
10/10 [==============================] - 0s 67us/sample - loss: 2.0941
Epoch 284/500
10/10 [==============================] - 0s 64us/sample - loss: 2.0410
Epoch 285/500
10/10 [==============================] - 0s 68us/sample - loss: 1.9892
Epoch 286/500
10/10 [==============================] - 0s 82us/sample - loss: 1.9387
Epoch 287/500
10/10 [==============================] - 0s 71us/sample - loss: 1.8895
Epoch 288/500
10/10 [==============================] - 0s 68us/sample - loss: 1.8415
Epoch 289/500
10/10 [==============================] - 0s 64us/sample - loss: 1.7948
Epoch 290/500
10/10 [==============================] - 0s 56us/sample - loss: 1.7493
Epoch 291/500
10/10 [==============================] - 0s 64us/sample - loss: 1.7049
Epoch 292/500
10/10 [==============================] - 0s 57us/sample - loss: 1.6616
Epoch 293/500
10/10 [==============================] - 0s 78us/sample - loss: 1.6194
Epoch 294/500
10/10 [==============================] - 0s 71us/sample - loss: 1.5783
Epoch 295/500
10/10 [==============================] - 0s 65us/sample - loss: 1.5383
Epoch 296/500
10/10 [==============================] - 0s 69us/sample - loss: 1.4993
Epoch 297/500
10/10 [==============================] - 0s 61us/sample - loss: 1.4612
Epoch 298/500
10/10 [==============================] - 0s 87us/sample - loss: 1.4241
Epoch 299/500
10/10 [==============================] - 0s 62us/sample - loss: 1.3880
Epoch 300/500
10/10 [==============================] - 0s 58us/sample - loss: 1.3528
Epoch 301/500
10/10 [==============================] - 0s 62us/sample - loss: 1.3184
Epoch 302/500
10/10 [==============================] - 0s 64us/sample - loss: 1.2850
Epoch 303/500
10/10 [==============================] - 0s 63us/sample - loss: 1.2524
Epoch 304/500
10/10 [==============================] - 0s 61us/sample - loss: 1.2206
Epoch 305/500
10/10 [==============================] - 0s 84us/sample - loss: 1.1896
Epoch 306/500
10/10 [==============================] - 0s 59us/sample - loss: 1.1594
Epoch 307/500
10/10 [==============================] - 0s 61us/sample - loss: 1.1300
Epoch 308/500
10/10 [==============================] - 0s 63us/sample - loss: 1.1013
Epoch 309/500
10/10 [==============================] - 0s 67us/sample - loss: 1.0734
Epoch 310/500
10/10 [==============================] - 0s 94us/sample - loss: 1.0461
Epoch 311/500
10/10 [==============================] - 0s 75us/sample - loss: 1.0196
Epoch 312/500
10/10 [==============================] - 0s 67us/sample - loss: 0.9937
Epoch 313/500
10/10 [==============================] - 0s 63us/sample - loss: 0.9685
Epoch 314/500
10/10 [==============================] - 0s 60us/sample - loss: 0.9439
Epoch 315/500
10/10 [==============================] - 0s 70us/sample - loss: 0.9200
Epoch 316/500
10/10 [==============================] - 0s 65us/sample - loss: 0.8966
Epoch 317/500
10/10 [==============================] - 0s 113us/sample - loss: 0.8739
Epoch 318/500
10/10 [==============================] - 0s 62us/sample - loss: 0.8517
Epoch 319/500
10/10 [==============================] - 0s 65us/sample - loss: 0.8301
Epoch 320/500
10/10 [==============================] - 0s 59us/sample - loss: 0.8090
Epoch 321/500
10/10 [==============================] - 0s 66us/sample - loss: 0.7885
Epoch 322/500
10/10 [==============================] - 0s 62us/sample - loss: 0.7685
Epoch 323/500
10/10 [==============================] - 0s 60us/sample - loss: 0.7490
Epoch 324/500
10/10 [==============================] - 0s 78us/sample - loss: 0.7300
Epoch 325/500
10/10 [==============================] - 0s 62us/sample - loss: 0.7114
Epoch 326/500
10/10 [==============================] - 0s 66us/sample - loss: 0.6934
Epoch 327/500
10/10 [==============================] - 0s 60us/sample - loss: 0.6758
Epoch 328/500
10/10 [==============================] - 0s 83us/sample - loss: 0.6586
Epoch 329/500
10/10 [==============================] - 0s 67us/sample - loss: 0.6419
Epoch 330/500
10/10 [==============================] - 0s 68us/sample - loss: 0.6256
Epoch 331/500
10/10 [==============================] - 0s 60us/sample - loss: 0.6097
Epoch 332/500
10/10 [==============================] - 0s 82us/sample - loss: 0.5943
Epoch 333/500
10/10 [==============================] - 0s 73us/sample - loss: 0.5792
Epoch 334/500
10/10 [==============================] - 0s 56us/sample - loss: 0.5645
Epoch 335/500
10/10 [==============================] - 0s 64us/sample - loss: 0.5502
Epoch 336/500
10/10 [==============================] - 0s 98us/sample - loss: 0.5362
Epoch 337/500
10/10 [==============================] - 0s 64us/sample - loss: 0.5226
Epoch 338/500
10/10 [==============================] - 0s 54us/sample - loss: 0.5093
Epoch 339/500
10/10 [==============================] - 0s 65us/sample - loss: 0.4964
Epoch 340/500
10/10 [==============================] - 0s 59us/sample - loss: 0.4838
Epoch 341/500
10/10 [==============================] - 0s 62us/sample - loss: 0.4715
Epoch 342/500
10/10 [==============================] - 0s 61us/sample - loss: 0.4596
Epoch 343/500
10/10 [==============================] - 0s 82us/sample - loss: 0.4479
Epoch 344/500
10/10 [==============================] - 0s 62us/sample - loss: 0.4365
Epoch 345/500
10/10 [==============================] - 0s 58us/sample - loss: 0.4255
Epoch 346/500
10/10 [==============================] - 0s 76us/sample - loss: 0.4147
Epoch 347/500
10/10 [==============================] - 0s 56us/sample - loss: 0.4041
Epoch 348/500
10/10 [==============================] - 0s 62us/sample - loss: 0.3939
Epoch 349/500
10/10 [==============================] - 0s 60us/sample - loss: 0.3839
Epoch 350/500
10/10 [==============================] - 0s 54us/sample - loss: 0.3741
Epoch 351/500
10/10 [==============================] - 0s 54us/sample - loss: 0.3646
Epoch 352/500
10/10 [==============================] - 0s 62us/sample - loss: 0.3554
Epoch 353/500
10/10 [==============================] - 0s 71us/sample - loss: 0.3464
Epoch 354/500
10/10 [==============================] - 0s 69us/sample - loss: 0.3376
Epoch 355/500
10/10 [==============================] - 0s 73us/sample - loss: 0.3290
Epoch 356/500
10/10 [==============================] - 0s 75us/sample - loss: 0.3207
Epoch 357/500
10/10 [==============================] - 0s 64us/sample - loss: 0.3125
Epoch 358/500
10/10 [==============================] - 0s 62us/sample - loss: 0.3046
Epoch 359/500
10/10 [==============================] - 0s 67us/sample - loss: 0.2969
Epoch 360/500
10/10 [==============================] - 0s 67us/sample - loss: 0.2893
Epoch 361/500
10/10 [==============================] - 0s 65us/sample - loss: 0.2820
Epoch 362/500
10/10 [==============================] - 0s 67us/sample - loss: 0.2748
Epoch 363/500
10/10 [==============================] - 0s 70us/sample - loss: 0.2679
Epoch 364/500
10/10 [==============================] - 0s 68us/sample - loss: 0.2611
Epoch 365/500
10/10 [==============================] - 0s 59us/sample - loss: 0.2544
Epoch 366/500
10/10 [==============================] - 0s 61us/sample - loss: 0.2480
Epoch 367/500
10/10 [==============================] - 0s 53us/sample - loss: 0.2417
Epoch 368/500
10/10 [==============================] - 0s 62us/sample - loss: 0.2355
Epoch 369/500
10/10 [==============================] - 0s 62us/sample - loss: 0.2296
Epoch 370/500
10/10 [==============================] - 0s 53us/sample - loss: 0.2237
Epoch 371/500
10/10 [==============================] - 0s 62us/sample - loss: 0.2181
Epoch 372/500
10/10 [==============================] - 0s 54us/sample - loss: 0.2125
Epoch 373/500
10/10 [==============================] - 0s 63us/sample - loss: 0.2071
Epoch 374/500
10/10 [==============================] - 0s 56us/sample - loss: 0.2019
Epoch 375/500
10/10 [==============================] - 0s 63us/sample - loss: 0.1968
Epoch 376/500
10/10 [==============================] - 0s 67us/sample - loss: 0.1918
Epoch 377/500
10/10 [==============================] - 0s 68us/sample - loss: 0.1869
Epoch 378/500
10/10 [==============================] - 0s 54us/sample - loss: 0.1822
Epoch 379/500
10/10 [==============================] - 0s 71us/sample - loss: 0.1775
Epoch 380/500
10/10 [==============================] - 0s 69us/sample - loss: 0.1730
Epoch 381/500
10/10 [==============================] - 0s 71us/sample - loss: 0.1686
Epoch 382/500
10/10 [==============================] - 0s 71us/sample - loss: 0.1644
Epoch 383/500
10/10 [==============================] - 0s 82us/sample - loss: 0.1602
Epoch 384/500
10/10 [==============================] - 0s 87us/sample - loss: 0.1561
Epoch 385/500
10/10 [==============================] - 0s 87us/sample - loss: 0.1522
Epoch 386/500
10/10 [==============================] - 0s 76us/sample - loss: 0.1483
Epoch 387/500
10/10 [==============================] - 0s 69us/sample - loss: 0.1445
Epoch 388/500
10/10 [==============================] - 0s 60us/sample - loss: 0.1409
Epoch 389/500
10/10 [==============================] - 0s 71us/sample - loss: 0.1373
Epoch 390/500
10/10 [==============================] - 0s 65us/sample - loss: 0.1338
Epoch 391/500
10/10 [==============================] - 0s 68us/sample - loss: 0.1304
Epoch 392/500
10/10 [==============================] - 0s 72us/sample - loss: 0.1271
Epoch 393/500
10/10 [==============================] - 0s 66us/sample - loss: 0.1239
Epoch 394/500
10/10 [==============================] - 0s 64us/sample - loss: 0.1207
Epoch 395/500
10/10 [==============================] - 0s 64us/sample - loss: 0.1177
Epoch 396/500
10/10 [==============================] - 0s 65us/sample - loss: 0.1147
Epoch 397/500
10/10 [==============================] - 0s 61us/sample - loss: 0.1118
Epoch 398/500
10/10 [==============================] - 0s 63us/sample - loss: 0.1089
Epoch 399/500
10/10 [==============================] - 0s 65us/sample - loss: 0.1062
Epoch 400/500
10/10 [==============================] - 0s 67us/sample - loss: 0.1035
Epoch 401/500
10/10 [==============================] - 0s 93us/sample - loss: 0.1009
Epoch 402/500
10/10 [==============================] - 0s 70us/sample - loss: 0.0983
Epoch 403/500
10/10 [==============================] - 0s 68us/sample - loss: 0.0958
Epoch 404/500
10/10 [==============================] - 0s 67us/sample - loss: 0.0934
Epoch 405/500
10/10 [==============================] - 0s 64us/sample - loss: 0.0910
Epoch 406/500
10/10 [==============================] - 0s 60us/sample - loss: 0.0887
Epoch 407/500
10/10 [==============================] - 0s 64us/sample - loss: 0.0864
Epoch 408/500
10/10 [==============================] - 0s 63us/sample - loss: 0.0842
Epoch 409/500
10/10 [==============================] - 0s 93us/sample - loss: 0.0821
Epoch 410/500
10/10 [==============================] - 0s 69us/sample - loss: 0.0800
Epoch 411/500
10/10 [==============================] - 0s 66us/sample - loss: 0.0780
Epoch 412/500
10/10 [==============================] - 0s 58us/sample - loss: 0.0760
Epoch 413/500
10/10 [==============================] - 0s 68us/sample - loss: 0.0741
Epoch 414/500
10/10 [==============================] - 0s 138us/sample - loss: 0.0722
Epoch 415/500
10/10 [==============================] - 0s 65us/sample - loss: 0.0704
Epoch 416/500
10/10 [==============================] - 0s 62us/sample - loss: 0.0686
Epoch 417/500
10/10 [==============================] - 0s 57us/sample - loss: 0.0668
Epoch 418/500
10/10 [==============================] - 0s 60us/sample - loss: 0.0652
Epoch 419/500
10/10 [==============================] - 0s 53us/sample - loss: 0.0635
Epoch 420/500
10/10 [==============================] - 0s 59us/sample - loss: 0.0619
Epoch 421/500
10/10 [==============================] - 0s 63us/sample - loss: 0.0603
Epoch 422/500
10/10 [==============================] - 0s 62us/sample - loss: 0.0588
Epoch 423/500
10/10 [==============================] - 0s 61us/sample - loss: 0.0573
Epoch 424/500
10/10 [==============================] - 0s 55us/sample - loss: 0.0558
Epoch 425/500
10/10 [==============================] - 0s 66us/sample - loss: 0.0544
Epoch 426/500
10/10 [==============================] - 0s 58us/sample - loss: 0.0530
Epoch 427/500
10/10 [==============================] - 0s 59us/sample - loss: 0.0517
Epoch 428/500
10/10 [==============================] - 0s 61us/sample - loss: 0.0504
Epoch 429/500
10/10 [==============================] - 0s 56us/sample - loss: 0.0491
Epoch 430/500
10/10 [==============================] - 0s 63us/sample - loss: 0.0479
Epoch 431/500
10/10 [==============================] - 0s 63us/sample - loss: 0.0467
Epoch 432/500
10/10 [==============================] - 0s 68us/sample - loss: 0.0455
Epoch 433/500
10/10 [==============================] - 0s 66us/sample - loss: 0.0443
Epoch 434/500
10/10 [==============================] - 0s 75us/sample - loss: 0.0432
Epoch 435/500
10/10 [==============================] - 0s 93us/sample - loss: 0.0421
Epoch 436/500
10/10 [==============================] - 0s 70us/sample - loss: 0.0410
Epoch 437/500
10/10 [==============================] - 0s 66us/sample - loss: 0.0400
Epoch 438/500
10/10 [==============================] - 0s 59us/sample - loss: 0.0390
Epoch 439/500
10/10 [==============================] - 0s 54us/sample - loss: 0.0380
Epoch 440/500
10/10 [==============================] - 0s 61us/sample - loss: 0.0370
Epoch 441/500
10/10 [==============================] - 0s 58us/sample - loss: 0.0361
Epoch 442/500
10/10 [==============================] - 0s 60us/sample - loss: 0.0352
Epoch 443/500
10/10 [==============================] - 0s 60us/sample - loss: 0.0343
Epoch 444/500
10/10 [==============================] - 0s 70us/sample - loss: 0.0334
Epoch 445/500
10/10 [==============================] - 0s 85us/sample - loss: 0.0326
Epoch 446/500
10/10 [==============================] - 0s 70us/sample - loss: 0.0317
Epoch 447/500
10/10 [==============================] - 0s 65us/sample - loss: 0.0309
Epoch 448/500
10/10 [==============================] - 0s 62us/sample - loss: 0.0301
Epoch 449/500
10/10 [==============================] - 0s 69us/sample - loss: 0.0294
Epoch 450/500
10/10 [==============================] - 0s 64us/sample - loss: 0.0286
Epoch 451/500
10/10 [==============================] - 0s 59us/sample - loss: 0.0279
Epoch 452/500
10/10 [==============================] - 0s 62us/sample - loss: 0.0272
Epoch 453/500
10/10 [==============================] - 0s 59us/sample - loss: 0.0265
Epoch 454/500
10/10 [==============================] - 0s 57us/sample - loss: 0.0258
Epoch 455/500
10/10 [==============================] - 0s 62us/sample - loss: 0.0252
Epoch 456/500
10/10 [==============================] - 0s 58us/sample - loss: 0.0245
Epoch 457/500
10/10 [==============================] - 0s 170us/sample - loss: 0.0239
Epoch 458/500
10/10 [==============================] - 0s 66us/sample - loss: 0.0233
Epoch 459/500
10/10 [==============================] - 0s 54us/sample - loss: 0.0227
Epoch 460/500
10/10 [==============================] - 0s 68us/sample - loss: 0.0221
Epoch 461/500
10/10 [==============================] - 0s 53us/sample - loss: 0.0216
Epoch 462/500
10/10 [==============================] - 0s 64us/sample - loss: 0.0210
Epoch 463/500
10/10 [==============================] - 0s 59us/sample - loss: 0.0205
Epoch 464/500
10/10 [==============================] - 0s 62us/sample - loss: 0.0200
Epoch 465/500
10/10 [==============================] - 0s 64us/sample - loss: 0.0195
Epoch 466/500
10/10 [==============================] - 0s 58us/sample - loss: 0.0190
Epoch 467/500
10/10 [==============================] - 0s 62us/sample - loss: 0.0185
Epoch 468/500
10/10 [==============================] - 0s 57us/sample - loss: 0.0180
Epoch 469/500
10/10 [==============================] - 0s 111us/sample - loss: 0.0176
Epoch 470/500
10/10 [==============================] - 0s 70us/sample - loss: 0.0171
Epoch 471/500
10/10 [==============================] - 0s 59us/sample - loss: 0.0167
Epoch 472/500
10/10 [==============================] - 0s 59us/sample - loss: 0.0163
Epoch 473/500
10/10 [==============================] - 0s 61us/sample - loss: 0.0158
Epoch 474/500
10/10 [==============================] - 0s 63us/sample - loss: 0.0154
Epoch 475/500
10/10 [==============================] - 0s 55us/sample - loss: 0.0151
Epoch 476/500
10/10 [==============================] - 0s 59us/sample - loss: 0.0147
Epoch 477/500
10/10 [==============================] - 0s 66us/sample - loss: 0.0143
Epoch 478/500
10/10 [==============================] - 0s 63us/sample - loss: 0.0139
Epoch 479/500
10/10 [==============================] - 0s 54us/sample - loss: 0.0136
Epoch 480/500
10/10 [==============================] - 0s 61us/sample - loss: 0.0132
Epoch 481/500
10/10 [==============================] - 0s 67us/sample - loss: 0.0129
Epoch 482/500
10/10 [==============================] - 0s 68us/sample - loss: 0.0126
Epoch 483/500
10/10 [==============================] - 0s 61us/sample - loss: 0.0123
Epoch 484/500
10/10 [==============================] - 0s 64us/sample - loss: 0.0119
Epoch 485/500
10/10 [==============================] - 0s 66us/sample - loss: 0.0116
Epoch 486/500
10/10 [==============================] - 0s 60us/sample - loss: 0.0113
Epoch 487/500
10/10 [==============================] - 0s 65us/sample - loss: 0.0111
Epoch 488/500
10/10 [==============================] - 0s 68us/sample - loss: 0.0108
Epoch 489/500
10/10 [==============================] - 0s 70us/sample - loss: 0.0105
Epoch 490/500
10/10 [==============================] - 0s 72us/sample - loss: 0.0102
Epoch 491/500
10/10 [==============================] - 0s 81us/sample - loss: 0.0100
Epoch 492/500
10/10 [==============================] - 0s 76us/sample - loss: 0.0097
Epoch 493/500
10/10 [==============================] - 0s 78us/sample - loss: 0.0095
Epoch 494/500
10/10 [==============================] - 0s 78us/sample - loss: 0.0092
Epoch 495/500
10/10 [==============================] - 0s 71us/sample - loss: 0.0090
Epoch 496/500
10/10 [==============================] - 0s 72us/sample - loss: 0.0088
Epoch 497/500
10/10 [==============================] - 0s 66us/sample - loss: 0.0086
Epoch 498/500
10/10 [==============================] - 0s 62us/sample - loss: 0.0083
Epoch 499/500
10/10 [==============================] - 0s 62us/sample - loss: 0.0081
Epoch 500/500
10/10 [==============================] - 0s 63us/sample - loss: 0.0079
#+end_example
** Make a Prediction
   What would /y/ be if /x=100/?
#+begin_src python :results output :exports both
input_value = [100.0]
predicted = model.predict(input_value)
print(predicted)
#+end_src

#+RESULTS:
: [[570.1017]]

The actual value is

#+begin_src python :results output :exports both
actual = (100 * slope) + intercept
print(f"y = {actual}")
print(f"difference = {actual - predicted[0][0]}")
#+end_src

#+RESULTS:
: y = 569
: difference = -1.1016845703125

So it was pretty close, but not exact.
*** Comparing to a Linear Regression Model

#+begin_src python :results output :exports both
regression = linear_model.LinearRegression()
regression.fit(X.reshape(-1, 1), Y)
prediction = regression.predict([input_value])
print(prediction)
#+end_src

#+RESULTS:
: [569.]

The linear model got it exactly right, as you might expect, but this isn't really a problem that exploits the positive features of machine learning.
* End
 - Taken from [[https://github.com/lmoroney/dlaicourse/blob/master/Course%201%20-%20Part%202%20-%20Lesson%202%20-%20Notebook.ipynb]["The Hello World of Deep Learning With Neural Networks" notebook on github]]



