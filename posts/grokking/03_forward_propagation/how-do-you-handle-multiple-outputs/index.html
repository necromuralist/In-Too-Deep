<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content='Notes from "Grokking Deep Learning" on handling multiple outputs.' name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>How do you handle multiple outputs? | In Too Deep</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../../rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/In-Too-Deep/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/" rel="canonical"><!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../../site.webmanifest" rel="manifest">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<script async src="../../../assets/javascript/bokeh-1.3.4.min.js" type="text/javascript"></script>
<meta content="Cloistered Monkey" name="author">
<link href="/posts/grokking/03_forward_propagation/how-do-neural-networks-work/" rel="prev" title="How Do Neurons Work?" type="text/html">
<link href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/" rel="next" title="How do you handle multiple inputs and outputs?" type="text/html">
<meta content="In Too Deep" property="og:site_name">
<meta content="How do you handle multiple outputs?" property="og:title">
<meta content="https://necromuralist.github.io/In-Too-Deep/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/" property="og:url">
<meta content="Notes from &quot;Grokking Deep Learning&quot; on handling multiple outputs." property="og:description">
<meta content="article" property="og:type">
<meta content="2018-10-19T14:30:27-07:00" property="article:published_time">
<meta content="grokking" property="article:tag">
<meta content="neural networks" property="article:tag">
<meta content="notes" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="https://necromuralist.github.io/In-Too-Deep/"><span id="blog-title">In Too Deep</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="/archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="/categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="/rss.xml">RSS feed</a></li>
<li class="nav-item"><a class="nav-link" href="https://necromuralist.github.io/">Cloistered Monkey</a></li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/In-Too-Deep/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/">How do you handle multiple outputs?</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/" rel="bookmark"><time class="published dt-published" datetime="2018-10-19T14:30:27-07:00" itemprop="datePublished" title="2018-10-19 14:30">2018-10-19 14:30</time></a></p>
<p class="sourceline"><a class="sourcelink" href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#org03599ea">Preliminaries</a>
<ul>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#orgdd2fc48">Imports</a></li>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#org60d8df1">Set Up</a></li>
</ul>
</li>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#org98ebe3f">Beginning</a>
<ul>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#orgedfd4c0">What is this?</a></li>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#org1fa4eea">How do you handle one input and multiple outputs?</a></li>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#org36862bd">How do you implement this?</a></li>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#org5080121">In Action</a></li>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#org9efeb7a">How would you do this with numpy?</a></li>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#org4e4ce50">Pytorch?</a></li>
</ul>
</li>
<li><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/#org55f9b64">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org03599ea">
<h2 id="org03599ea">Preliminaries</h2>
<div class="outline-text-2" id="text-org03599ea"></div>
<div class="outline-3" id="outline-container-orgdd2fc48">
<h3 id="orgdd2fc48">Imports</h3>
<div class="outline-text-3" id="text-orgdd2fc48"></div>
<div class="outline-4" id="outline-container-org0958aad">
<h4 id="org0958aad">From Python</h4>
<div class="outline-text-4" id="text-org0958aad">
<div class="highlight">
<pre><span></span> <span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
 <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orge4ec5c1">
<h4 id="orge4ec5c1">From PyPi</h4>
<div class="outline-text-4" id="text-orge4ec5c1">
<div class="highlight">
<pre><span></span> <span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Digraph</span>
 <span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org60d8df1">
<h3 id="org60d8df1">Set Up</h3>
<div class="outline-text-3" id="text-org60d8df1"></div>
<div class="outline-4" id="outline-container-org1fc8e7f">
<h4 id="org1fc8e7f">The Output Folder</h4>
<div class="outline-text-4" id="text-org1fc8e7f">
<p>This is where to put rendered images.</p>
<div class="highlight">
<pre><span></span><span class="n">PATH</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../../files/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org46ffd93">
<h4 id="org46ffd93">Data Types</h4>
<div class="outline-text-4" id="text-org46ffd93">
<div class="highlight">
<pre><span></span><span class="n">Vector</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org98ebe3f">
<h2 id="org98ebe3f">Beginning</h2>
<div class="outline-text-2" id="text-org98ebe3f"></div>
<div class="outline-3" id="outline-container-orgedfd4c0">
<h3 id="orgedfd4c0">What is this?</h3>
<div class="outline-text-3" id="text-orgedfd4c0">
<p>This is a continuation of my notes on Chapter Three of "Grokking Deep Learning". In the previous post we looked at a simple neural network with three inputs and one output. Here we'll look at handling multiple outputs.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org1fa4eea">
<h3 id="org1fa4eea">How do you handle one input and multiple outputs?</h3>
<div class="outline-text-3" id="text-org1fa4eea">
<p>Suppose instead of using multiple inputs to predict an outcome (like winning) you instead had a single input and multiple outputs (like what percentage feels sad, or indifferent based on whether you won or lost as well as whether you will win). You could create a network to represent it something like this.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Feelings Model"</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">"rankdir"</span><span class="p">:</span> <span class="s2">"LR"</span><span class="p">,</span> <span class="s2">"dpi"</span><span class="p">:</span> <span class="s2">"200"</span><span class="p">})</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"Won/Lost"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="s2">"Hurt"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"C"</span><span class="p">,</span> <span class="s2">"Win"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"D"</span><span class="p">,</span> <span class="s2">"Sad"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".3"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".2"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".9"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">PATH</span><span class="o">/</span><span class="s2">"feelings_model.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure">
<p><img alt="feelings_model.dot.png" src="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/feelings_model.dot.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org36862bd">
<h3 id="org36862bd">How do you implement this?</h3>
<div class="outline-text-3" id="text-org36862bd">
<p>In this case the outputs are simply the (single) input times the weight of the output, so while the single output was the dot-product of the inputs and the weights, this, the multiple output case, is an elementwise multiplication of the input and the weights.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">elementwise_multiplication</span><span class="p">(</span><span class="n">scalar</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vector</span><span class="p">:</span>
    <span class="sd">"""multiplies the value against each of the weights</span>

<span class="sd">    Returns:</span>
<span class="sd">     output: scalar times each of the weights as a list</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">scalar</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org5080121">
<h3 id="org5080121">In Action</h3>
<div class="outline-text-3" id="text-org5080121">
<p>Here's some sample values that we can use to see what this network gives us. Our input is the fraction of the games won up to a given week and our outputs are the fraction of players that are hurt, the probability that they won or lost, and whether the players are happy or sad.</p>
<div class="highlight">
<pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="s2">"Hurt Win Sad"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="n">fraction_of_wins</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
</pre></div>
<p>These are the probabilities of a fan feeling a certain way the first week.</p>
<div class="highlight">
<pre><span></span><span class="n">wins</span> <span class="o">=</span> <span class="n">fraction_of_wins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.195</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.585</span><span class="p">]</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">elementwise_multiplication</span><span class="p">(</span><span class="n">wins</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">**</span><span class="mi">5</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">actual</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expected</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">-</span> <span class="n">item</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tolerance</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Feelings Model"</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">"rankdir"</span><span class="p">:</span> <span class="s2">"LR"</span><span class="p">,</span> <span class="s2">"dpi"</span><span class="p">:</span> <span class="s2">"200"</span><span class="p">})</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Wins={wins}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Hurt={actual[0]:.3f}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"C"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Win={actual[1]:.3f}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"D"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Sad={actual[2]:.3f}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".3"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".2"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".9"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">PATH</span><span class="o">/</span><span class="s2">"feelings_model_with_output.dot"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"[[file:feelings_model_with_output.dot.png]]"</span><span class="p">)</span>
</pre></div>
<div class="figure">
<p><img alt="feelings_model_with_output.dot.png" src="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/feelings_model_with_output.dot.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org9efeb7a">
<h3 id="org9efeb7a">How would you do this with numpy?</h3>
<div class="outline-text-3" id="text-org9efeb7a">
<p>Since this is just element-wise multiplication, all you have to do is create an array and then multiply it by the scalar input.</p>
<div class="highlight">
<pre><span></span><span class="n">vector_weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">vector_weights</span> <span class="o">*</span> <span class="n">wins</span>
<span class="n">vector_expected</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">expected</span><span class="p">)</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Feelings Model"</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">"rankdir"</span><span class="p">:</span> <span class="s2">"LR"</span><span class="p">,</span> <span class="s2">"dpi"</span><span class="p">:</span> <span class="s2">"200"</span><span class="p">})</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Wins={wins}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Hurt={actual[0]:.3f}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"C"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Win={actual[1]:.3f}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"D"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Sad={actual[2]:.3f}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".3"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".2"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".9"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">PATH</span><span class="o">/</span><span class="s2">"numpy_feelings_model_with_output.dot"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"[[file:numpy_feelings_model_with_output.dot.png]]"</span><span class="p">)</span>
</pre></div>
<div class="figure">
<p><img alt="numpy_feelings_model_with_output.dot.png" src="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/numpy_feelings_model_with_output.dot.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org4e4ce50">
<h3 id="org4e4ce50">Pytorch?</h3>
<div class="outline-text-3" id="text-org4e4ce50">
<p>Like numpy, pytorch uses the multiplication operator for element-wise multiplication.</p>
<div class="highlight">
<pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cpu"</span><span class="p">)</span>
<span class="n">weights_vector</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="p">(</span><span class="n">weights_vector</span> <span class="o">*</span> <span class="n">wins</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Feelings Model"</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">"rankdir"</span><span class="p">:</span> <span class="s2">"LR"</span><span class="p">,</span> <span class="s2">"dpi"</span><span class="p">:</span> <span class="s2">"200"</span><span class="p">})</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Wins={wins}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Hurt={actual[0]:.3f}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"C"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Win={actual[1]:.3f}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"D"</span><span class="p">,</span> <span class="n">f</span><span class="s2">"Sad={actual[2]:.3f}"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".3"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".2"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".9"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">PATH</span><span class="o">/</span><span class="s2">"pytorch_feelings_model_with_output.dot"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"[[file:pytorch_feelings_model_with_output.dot.png]]"</span><span class="p">)</span>
</pre></div>
<div class="figure">
<p><img alt="pytorch_feelings_model_with_output.dot.png" src="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/pytorch_feelings_model_with_output.dot.png"></p>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org55f9b64">
<h2 id="org55f9b64">End</h2>
<div class="outline-text-2" id="text-org55f9b64">
<p>So that's it for handling multiple outputs from a node to multiple nodes. As with the many inputs to one node what you're really doing is vector math, when reducing from many to one you use the dot product and when going from one to many you use scalar multiplication.</p>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="/categories/grokking/" rel="tag">grokking</a></li>
<li><a class="tag p-category" href="/categories/neural-networks/" rel="tag">neural networks</a></li>
<li><a class="tag p-category" href="/categories/notes/" rel="tag">notes</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="/posts/grokking/03_forward_propagation/how-do-neural-networks-work/" rel="prev" title="How Do Neurons Work?">Previous post</a></li>
<li class="next"><a href="/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/" rel="next" title="How do you handle multiple inputs and outputs?">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Contents © 2020 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="/assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script> 
</body>
</html>
